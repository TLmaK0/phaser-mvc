(function(e, a) { for(var i in a) e[i] = a[i]; }(exports, /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var watch_model_1 = __webpack_require__(6);
var rxjs_1 = __webpack_require__(7);
var _ = __webpack_require__(8);
var WatchFactory = /** @class */ (function () {
    function WatchFactory() {
        this.watchsModel = [];
    }
    WatchFactory.prototype.create = function (getModel) {
        var watchModel = new watch_model_1.WatchModel();
        watchModel.observable = rxjs_1.Observable.create(function (observer) { return watchModel.observer = observer; }).map(function (model) { return _.cloneDeep(model); }).distinctUntilChanged(function (prev, next) { return _.isEqual(prev, next); });
        watchModel.getModel = getModel;
        this.watchsModel.push(watchModel);
        return watchModel.observable;
    };
    return WatchFactory;
}());
exports.WatchFactory = WatchFactory;


/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var bootstrap_1 = __webpack_require__(2);
exports.Bootstrap = bootstrap_1.Bootstrap;
var controller_1 = __webpack_require__(4);
exports.Controller = controller_1.Controller;
var view_1 = __webpack_require__(5);
exports.View = view_1.View;
exports.ViewComponent = view_1.ViewComponent;
var watch_factory_1 = __webpack_require__(0);
exports.WatchFactory = watch_factory_1.WatchFactory;


/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

/**
 */
Object.defineProperty(exports, "__esModule", { value: true });
var Phaser = __webpack_require__(3);
/** Bootstrap for the phaser-mvc.
 * Useage:
 * import { FrameController } from 'phaser-mvc';
 * import { LandEditorController } from 'phaser-mvc';
 * window.onload = () => {
 * const boot = new Bootstrap();
 * boot.addController('FrameController', FrameController);
 */
var Bootstrap = /** @class */ (function () {
    function Bootstrap(width, height) {
        if (width === void 0) { width = 1920; }
        if (height === void 0) { height = 1080; }
        var _this = this;
        this.width = width;
        this.height = height;
        this.controllers = {};
        this.preload = function () {
            for (var _i = 0, _a = Bootstrap.preloadComponents; _i < _a.length; _i++) {
                var preload = _a[_i];
                preload(_this.game);
            }
        };
        this.create = function () {
            _this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            _this.goTo(_this.startAction[0], _this.startAction[1], _this.startAction[2]);
        };
        this.update = function () {
            for (var _i = 0, _a = Object.keys(_this.controllers); _i < _a.length; _i++) {
                var controllerName = _a[_i];
                _this.updateController(_this.controllers[controllerName]);
            }
        };
    }
    Bootstrap.preload = function (preload) {
        Bootstrap.preloadComponents.push(preload);
    };
    Bootstrap.prototype.start = function (controllerName, controllerAction, params) {
        this.startAction = [controllerName, controllerAction, params];
        this.game = new Phaser.Game(this.width, this.height, Phaser.CANVAS, 'content', { preload: this.preload,
            create: this.create,
            update: this.update });
    };
    Bootstrap.prototype.addController = function (name, controllerType) {
        if (this.controllers[name] != null)
            throw EvalError("Controller " + name + " already registered.");
        var controller = new controllerType();
        controller.bootstrap = this;
        this.controllers[name] = controller;
    };
    Bootstrap.prototype.goTo = function (controllerName, controllerAction, params) {
        /*tslint:disable:no-any*/
        var controller = this.controllers[controllerName];
        /*tslint:enable:no-any*/
        if (!controller) {
            throw EvalError("Controller " + controllerName + " not exist. Be sure you load it in bootstrap.");
        }
        /*tslint:disable:no-unsafe-any*/
        controller[controllerAction](params);
        /*tslint:enable:no-unsafe-any*/
    };
    Bootstrap.prototype.updateController = function (controller) {
        for (var _i = 0, _a = Object.keys(controller.views); _i < _a.length; _i++) {
            var viewName = _a[_i];
            controller.getView(viewName).updateView();
        }
    };
    Bootstrap.preloadComponents = [];
    return Bootstrap;
}());
exports.Bootstrap = Bootstrap;


/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = require("phaser-ce");

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Controller accepts input from view and converts modifieds the model.
 */
var Controller = /** @class */ (function () {
    function Controller() {
        var _this = this;
        this.views = {};
        this.model = {};
        this.goTo = function (controllerName, controllerAction, params) {
            _this.bootstrap.goTo(controllerName, controllerAction, params);
        };
    }
    Object.defineProperty(Controller.prototype, "game", {
        get: function () {
            return this.bootstrap.game;
        },
        enumerable: true,
        configurable: true
    });
    Controller.prototype.getView = function (viewName) {
        var view = this.views[viewName];
        if (view == null) {
            throw EvalError("View " + viewName + " not exist. Be sure you have added it to your controller.");
        }
        return view;
    };
    Controller.prototype.render = function (view) {
        view.init(this.game, this.model, this.goTo);
    };
    Controller.prototype.refresh = function (view) {
        view.refresh();
    };
    return Controller;
}());
exports.Controller = Controller;


/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var watch_factory_1 = __webpack_require__(0);
/**
 * Adds a component to the view and other view components
 */
var ViewComponentAdder = /** @class */ (function () {
    function ViewComponentAdder(components, view) {
        this.components = components;
        this.view = view;
    }
    ViewComponentAdder.prototype.addComponent = function (component) {
        this.components.push(component);
        component.createComponent(this, this.view);
        return component;
    };
    return ViewComponentAdder;
}());
exports.ViewComponentAdder = ViewComponentAdder;
/**
 * Input and ouput for the application
 */
var View = /** @class */ (function () {
    function View() {
        this.components = [];
        this.initiated = false;
        this.watchFactory = new watch_factory_1.WatchFactory();
    }
    View.prototype.refresh = function () {
        //empty, can be overrided or not
    };
    View.prototype.create = function (_componentAdder) {
        //empty, can be overrided or not
    };
    View.prototype.preload = function () {
        //empty, can be overrided or not
    };
    View.prototype.update = function () {
        //empty, can be overrided or not
    };
    View.prototype.init = function (game, model, goTo) {
        if (!this.initiated) {
            this._game = game;
            this._model = model;
            this._goTo = goTo;
            this.createView();
            this.initiated = true;
        }
    };
    Object.defineProperty(View.prototype, "game", {
        get: function () { return this._game; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "model", {
        get: function () { return this._model; },
        enumerable: true,
        configurable: true
    });
    View.prototype.createView = function () {
        var componentAdder = new ViewComponentAdder(this.components, this);
        this.create(componentAdder);
        this.updateOnModelChange(this.watchFactory);
    };
    View.prototype.updateView = function () {
        if (!this.initiated)
            return;
        this.checkWatchModels();
        this.update();
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.updateComponent();
        }
    };
    View.prototype.refreshView = function () {
        if (!this.initiated)
            throw EvalError('View is not rendered please render it before refresh.');
        this.refresh();
    };
    View.prototype.updateOnModelChange = function (_watchFactory) {
        //this should be overrided or not
    };
    View.prototype.checkWatchModels = function () {
        for (var _i = 0, _a = this.watchFactory.watchsModel; _i < _a.length; _i++) {
            var watchModel = _a[_i];
            watchModel.observer.next(watchModel.getModel());
        }
    };
    View.prototype.goTo = function (controllerName, controllerAction, params) {
        this._goTo(controllerName, controllerAction, params);
    };
    return View;
}());
exports.View = View;
/**
 * Component to be showed in view
 */
var ViewComponent = /** @class */ (function () {
    function ViewComponent() {
        this.components = [];
    }
    ViewComponent.prototype.create = function (_componentAdder) {
        //empty, can be overrided or not
    };
    ViewComponent.prototype.update = function () {
        //empty, can be overrided or not
    };
    ViewComponent.prototype.createComponent = function (componentAdder, view) {
        this.view = view;
        this.create(componentAdder);
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.createComponent(componentAdder, view);
        }
    };
    ViewComponent.prototype.updateComponent = function () {
        this.update();
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.updateComponent();
        }
    };
    Object.defineProperty(ViewComponent.prototype, "game", {
        get: function () {
            return this.view.game;
        },
        enumerable: true,
        configurable: true
    });
    return ViewComponent;
}());
exports.ViewComponent = ViewComponent;


/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var WatchModel = /** @class */ (function () {
    function WatchModel() {
    }
    return WatchModel;
}());
exports.WatchModel = WatchModel;


/***/ }),
/* 7 */
/***/ (function(module, exports) {

module.exports = require("@reactivex/rxjs");

/***/ }),
/* 8 */
/***/ (function(module, exports) {

module.exports = require("lodash");

/***/ })
/******/ ])));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNDhiZDc1MDU2ZDgxNzdhNTY3ZmUiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dhdGNoX2ZhY3RvcnkudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9ib290c3RyYXAudHMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicGhhc2VyLWNlXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnRyb2xsZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXcudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dhdGNoX21vZGVsLnRzIiwid2VicGFjazovLy9leHRlcm5hbCBcIkByZWFjdGl2ZXgvcnhqc1wiIiwid2VicGFjazovLy9leHRlcm5hbCBcImxvZGFzaFwiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQTJCLDBCQUEwQixFQUFFO0FBQ3ZELHlDQUFpQyxlQUFlO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUFzRCwrREFBK0Q7O0FBRXJIO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7OztBQzdEQSwyQ0FBMkM7QUFDM0Msb0NBQXVEO0FBQ3ZELCtCQUE0QjtBQUU1QjtJQUdFO1FBRk8sZ0JBQVcsR0FBc0IsRUFBRSxDQUFDO0lBRzNDLENBQUM7SUFFTSw2QkFBTSxHQUFiLFVBQWlCLFFBQWlCO1FBQ2hDLElBQU0sVUFBVSxHQUFHLElBQUksd0JBQVUsRUFBSyxDQUFDO1FBRXZDLFVBQVUsQ0FBQyxVQUFV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QUE7SUFDSCxvQkFBQztBQUFELENBQUM7QUE5QnFCLHNDQUFhOzs7Ozs7Ozs7O0FDL0ZuQztJQUFBO0lBSUEsQ0FBQztJQUFELGlCQUFDO0FBQUQsQ0FBQztBQUpZLGdDQUFVOzs7Ozs7O0FDRnZCLDRDOzs7Ozs7QUNBQSxtQyIsImZpbGUiOiJwaGFzZXItbXZjLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDQ4YmQ3NTA1NmQ4MTc3YTU2N2ZlIiwiaW1wb3J0IHsgV2F0Y2hNb2RlbCB9IGZyb20gJy4vd2F0Y2hfbW9kZWwnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgT2JzZXJ2ZXIgfSBmcm9tICdAcmVhY3RpdmV4L3J4anMnO1xuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuXG5leHBvcnQgY2xhc3MgV2F0Y2hGYWN0b3J5IHtcbiAgcHVibGljIHdhdGNoc01vZGVsOiBXYXRjaE1vZGVsPGFueT5bXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKCl7XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlPFQ+KGdldE1vZGVsOiAoKSA9PiBUKTogT2JzZXJ2YWJsZTxUPiB7XG4gICAgY29uc3Qgd2F0Y2hNb2RlbCA9IG5ldyBXYXRjaE1vZGVsPFQ+KCk7XG5cbiAgICB3YXRjaE1vZGVsLm9ic2VydmFibGUgPSBPYnNlcnZhYmxlLmNyZWF0ZShcbiAgICAgIChvYnNlcnZlcjogT2JzZXJ2ZXI8KCkgPT4gVD4pID0+IHdhdGNoTW9kZWwub2JzZXJ2ZXIgPSBvYnNlcnZlclxuICAgICkubWFwKFxuICAgICAgKG1vZGVsOiBUKSA9PiBfLmNsb25lRGVlcChtb2RlbClcbiAgICApLmRpc3RpbmN0VW50aWxDaGFuZ2VkKFxuICAgICAgKHByZXY6IFQsIG5leHQ6IFQpID0+IF8uaXNFcXVhbChwcmV2LCBuZXh0KVxuICAgICk7XG5cbiAgICB3YXRjaE1vZGVsLmdldE1vZGVsID0gZ2V0TW9kZWw7XG5cbiAgICB0aGlzLndhdGNoc01vZGVsLnB1c2god2F0Y2hNb2RlbCk7IFxuXG4gICAgcmV0dXJuIHdhdGNoTW9kZWwub2JzZXJ2YWJsZTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3dhdGNoX2ZhY3RvcnkudHMiLCJleHBvcnQgeyBCb290c3RyYXAgfSBmcm9tICcuL2Jvb3RzdHJhcCc7XG5leHBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnLi9jb250cm9sbGVyJztcbmV4cG9ydCB7IFZpZXcsIFZpZXdDb21wb25lbnQgfSBmcm9tICcuL3ZpZXcnO1xuZXhwb3J0IHsgV2F0Y2hGYWN0b3J5IH0gZnJvbSAnLi93YXRjaF9mYWN0b3J5JztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC50cyIsIi8qKlxuICovXG5cbmltcG9ydCAqIGFzIFBoYXNlciBmcm9tICdwaGFzZXItY2UnO1xuXG5pbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnLi9jb250cm9sbGVyJztcbmltcG9ydCB7IElBY3Rpb25QYXJhbXMgfSBmcm9tICcuL2lfYWN0aW9uX3BhcmFtcyc7XG5pbXBvcnQgeyBJQ29udHJvbGxlck1hcCB9IGZyb20gJy4vaV9jb250cm9sbGVyX21hcCc7XG5cbi8qKiBCb290c3RyYXAgZm9yIHRoZSBwaGFzZXItbXZjLlxuICogVXNlYWdlOlxuICogaW1wb3J0IHsgRnJhbWVDb250cm9sbGVyIH0gZnJvbSAncGhhc2VyLW12Yyc7XG4gKiBpbXBvcnQgeyBMYW5kRWRpdG9yQ29udHJvbGxlciB9IGZyb20gJ3BoYXNlci1tdmMnO1xuICogd2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAqIGNvbnN0IGJvb3QgPSBuZXcgQm9vdHN0cmFwKCk7XG4gKiBib290LmFkZENvbnRyb2xsZXIoJ0ZyYW1lQ29udHJvbGxlcicsIEZyYW1lQ29udHJvbGxlcik7XG4gKi9cblxuZXhwb3J0IGNsYXNzIEJvb3RzdHJhcCB7XG4gIHByaXZhdGUgc3RhdGljIHByZWxvYWRDb21wb25lbnRzOiAoKGdhbWU6IFBoYXNlci5HYW1lKSA9PiB2b2lkKVtdID0gW107XG5cbiAgcHVibGljIGdhbWU6IFBoYXNlci5HYW1lO1xuICBwcm90ZWN0ZWQgY29udHJvbGxlcnM6IElDb250cm9sbGVyTWFwID0ge307XG4gIHByaXZhdGUgc3RhcnRBY3Rpb246IFtzdHJpbmcsIHN0cmluZywgSUFjdGlvblBhcmFtc107XG5cbiAgcHVibGljIGNvbnN0cnVjdG9yKHB1YmxpYyB3aWR0aDogbnVtYmVyID0gMTkyMCwgcHVibGljIGhlaWdodDogbnVtYmVyID0gMTA4MCl7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHByZWxvYWQocHJlbG9hZDogKGdhbWU6IFBoYXNlci5HYW1lKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgQm9vdHN0cmFwLnByZWxvYWRDb21wb25lbnRzLnB1c2gocHJlbG9hZCk7XG4gIH1cblxuICBwdWJsaWMgc3RhcnQoY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpOiB2b2lkIHtcbiAgICB0aGlzLnN0YXJ0QWN0aW9uID0gW2NvbnRyb2xsZXJOYW1lLCBjb250cm9sbGVyQWN0aW9uLCBwYXJhbXNdO1xuICAgIHRoaXMuZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZShcbiAgICAgIHRoaXMud2lkdGgsXG4gICAgICB0aGlzLmhlaWdodCxcbiAgICAgIFBoYXNlci5DQU5WQVMsXG4gICAgICAnY29udGVudCcsXG4gICAgICB7IHByZWxvYWQ6IHRoaXMucHJlbG9hZCxcbiAgICAgICAgY3JlYXRlOiB0aGlzLmNyZWF0ZSxcbiAgICAgICAgdXBkYXRlOiB0aGlzLnVwZGF0ZX0pO1xuICB9XG5cbiAgcHVibGljIHByZWxvYWQgPSAoKTogdm9pZCA9PiB7XG4gICAgZm9yIChjb25zdCBwcmVsb2FkIG9mIEJvb3RzdHJhcC5wcmVsb2FkQ29tcG9uZW50cykge1xuICAgICAgcHJlbG9hZCh0aGlzLmdhbWUpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGUgPSAoKTogdm9pZCA9PiB7XG4gICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgdGhpcy5nb1RvKHRoaXMuc3RhcnRBY3Rpb25bMF0sIHRoaXMuc3RhcnRBY3Rpb25bMV0sIHRoaXMuc3RhcnRBY3Rpb25bMl0pO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZSA9ICgpOiB2b2lkID0+IHtcbiAgICBmb3IgKGNvbnN0IGNvbnRyb2xsZXJOYW1lIG9mIE9iamVjdC5rZXlzKHRoaXMuY29udHJvbGxlcnMpKSB7XG4gICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xsZXIoPENvbnRyb2xsZXI+dGhpcy5jb250cm9sbGVyc1tjb250cm9sbGVyTmFtZV0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhZGRDb250cm9sbGVyPFQgZXh0ZW5kcyBDb250cm9sbGVyPihuYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJUeXBlOiBuZXcgKCkgPT4gVCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbnRyb2xsZXJzW25hbWVdICE9IG51bGwpIHRocm93IEV2YWxFcnJvcihgQ29udHJvbGxlciAke25hbWV9IGFscmVhZHkgcmVnaXN0ZXJlZC5gKTtcblxuICAgIGNvbnN0IGNvbnRyb2xsZXI6IFQgPSBuZXcgY29udHJvbGxlclR5cGUoKTtcbiAgICBjb250cm9sbGVyLmJvb3RzdHJhcCA9IHRoaXM7XG4gICAgdGhpcy5jb250cm9sbGVyc1tuYW1lXSA9IGNvbnRyb2xsZXI7XG4gIH1cblxuICBwdWJsaWMgZ29Ubyhjb250cm9sbGVyTmFtZTogc3RyaW5nLCBjb250cm9sbGVyQWN0aW9uOiBzdHJpbmcsIHBhcmFtczogSUFjdGlvblBhcmFtcyk6IHZvaWQge1xuICAgIC8qdHNsaW50OmRpc2FibGU6bm8tYW55Ki9cbiAgICBjb25zdCBjb250cm9sbGVyOiBhbnkgPSB0aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJOYW1lXTtcbiAgICAvKnRzbGludDplbmFibGU6bm8tYW55Ki9cbiAgICBpZiAoIWNvbnRyb2xsZXIpIHtcbiAgICAgIHRocm93IEV2YWxFcnJvcihgQ29udHJvbGxlciAke2NvbnRyb2xsZXJOYW1lfSBub3QgZXhpc3QuIEJlIHN1cmUgeW91IGxvYWQgaXQgaW4gYm9vdHN0cmFwLmApO1xuICAgIH1cbiAgICAvKnRzbGludDpkaXNhYmxlOm5vLXVuc2FmZS1hbnkqL1xuICAgIGNvbnRyb2xsZXJbY29udHJvbGxlckFjdGlvbl0ocGFyYW1zKTtcbiAgICAvKnRzbGludDplbmFibGU6bm8tdW5zYWZlLWFueSovXG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUNvbnRyb2xsZXIoY29udHJvbGxlcjogQ29udHJvbGxlcik6IHZvaWQge1xuICAgIGZvciAoY29uc3Qgdmlld05hbWUgb2YgT2JqZWN0LmtleXMoY29udHJvbGxlci52aWV3cykpIHtcbiAgICAgIGNvbnRyb2xsZXIuZ2V0Vmlldyh2aWV3TmFtZSkudXBkYXRlVmlldygpO1xuICAgIH1cbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2Jvb3RzdHJhcC50cyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInBoYXNlci1jZVwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInBoYXNlci1jZVwiXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIFBoYXNlciBmcm9tICdwaGFzZXItY2UnO1xuXG5pbXBvcnQgeyBCb290c3RyYXAgfSBmcm9tICcuL2Jvb3RzdHJhcCc7XG5pbXBvcnQgeyBJQWN0aW9uUGFyYW1zIH0gZnJvbSAnLi9pX2FjdGlvbl9wYXJhbXMnO1xuaW1wb3J0IHsgSUNvbnRyb2xsZXJNYXAgfSBmcm9tICcuL2lfY29udHJvbGxlcl9tYXAnO1xuaW1wb3J0IHsgSU1vZGVsIH0gZnJvbSAnLi9pX21vZGVsJztcbmltcG9ydCB7IElWaWV3TWFwIH0gZnJvbSAnLi9pX3ZpZXdfbWFwJztcbmltcG9ydCB7IFZpZXcgfSBmcm9tICcuL3ZpZXcnO1xuXG4vKipcbiAqIENvbnRyb2xsZXIgYWNjZXB0cyBpbnB1dCBmcm9tIHZpZXcgYW5kIGNvbnZlcnRzIG1vZGlmaWVkcyB0aGUgbW9kZWwuXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb250cm9sbGVyIHtcbiAgcHVibGljIHZpZXdzOiBJVmlld01hcCA9IHt9O1xuICBwdWJsaWMgYm9vdHN0cmFwOiBCb290c3RyYXA7XG4gIHB1YmxpYyBtb2RlbDogSU1vZGVsID0ge307XG5cbiAgcHVibGljIGdldCBnYW1lKCk6IFBoYXNlci5HYW1lIHtcbiAgICByZXR1cm4gdGhpcy5ib290c3RyYXAuZ2FtZTtcbiAgfVxuXG4gIHB1YmxpYyBnb1RvID0gKGNvbnRyb2xsZXJOYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJBY3Rpb246IHN0cmluZywgcGFyYW1zOiBJQWN0aW9uUGFyYW1zKSA9PiB7XG4gICAgdGhpcy5ib290c3RyYXAuZ29Ubyhjb250cm9sbGVyTmFtZSwgY29udHJvbGxlckFjdGlvbiwgcGFyYW1zKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRWaWV3KHZpZXdOYW1lOiBzdHJpbmcpOiBWaWV3IHtcbiAgICBjb25zdCB2aWV3ID0gdGhpcy52aWV3c1t2aWV3TmFtZV07XG4gICAgaWYgKHZpZXcgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgRXZhbEVycm9yKGBWaWV3ICR7dmlld05hbWV9IG5vdCBleGlzdC4gQmUgc3VyZSB5b3UgaGF2ZSBhZGRlZCBpdCB0byB5b3VyIGNvbnRyb2xsZXIuYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZpZXc7XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVuZGVyKHZpZXc6IFZpZXcpOiB2b2lkIHtcbiAgICB2aWV3LmluaXQodGhpcy5nYW1lLCB0aGlzLm1vZGVsLCB0aGlzLmdvVG8pO1xuICB9XG5cbiAgcHJvdGVjdGVkIHJlZnJlc2godmlldzogVmlldyk6IHZvaWQge1xuICAgIHZpZXcucmVmcmVzaCgpO1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29udHJvbGxlci50cyIsImltcG9ydCAqIGFzIFBoYXNlciBmcm9tICdwaGFzZXItY2UnO1xuXG5pbXBvcnQgeyBJQWN0aW9uUGFyYW1zIH0gZnJvbSAnLi9pX2FjdGlvbl9wYXJhbXMnO1xuaW1wb3J0IHsgSU1vZGVsIH0gZnJvbSAnLi9pX21vZGVsJztcbmltcG9ydCB7IFdhdGNoTW9kZWwgfSBmcm9tICcuL3dhdGNoX21vZGVsJztcbmltcG9ydCB7IFdhdGNoRmFjdG9yeSB9IGZyb20gJy4vd2F0Y2hfZmFjdG9yeSc7XG5cbi8qKlxuICogQWRkcyBhIGNvbXBvbmVudCB0byB0aGUgdmlldyBhbmQgb3RoZXIgdmlldyBjb21wb25lbnRzXG4gKi9cbmV4cG9ydCBjbGFzcyBWaWV3Q29tcG9uZW50QWRkZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbXBvbmVudHM6IFZpZXdDb21wb25lbnRbXSwgcHJpdmF0ZSB2aWV3OiBWaWV3KSB7fVxuXG4gIHB1YmxpYyBhZGRDb21wb25lbnQ8VCBleHRlbmRzIFZpZXdDb21wb25lbnQ+KGNvbXBvbmVudDogVCk6IFQge1xuICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgY29tcG9uZW50LmNyZWF0ZUNvbXBvbmVudCh0aGlzLCB0aGlzLnZpZXcpO1xuXG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgfVxufVxuXG4vKipcbiAqIElucHV0IGFuZCBvdXB1dCBmb3IgdGhlIGFwcGxpY2F0aW9uXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBWaWV3IHtcbiAgcHJvdGVjdGVkIGNvbXBvbmVudHM6IFZpZXdDb21wb25lbnRbXSA9IFtdO1xuICBwcm90ZWN0ZWQgaW5pdGlhdGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgX2dhbWU6IFBoYXNlci5HYW1lO1xuICBwcml2YXRlIF9tb2RlbDogSU1vZGVsO1xuICBwcml2YXRlIF9nb1RvOiAoY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpID0+IHZvaWQ7XG4gIHByaXZhdGUgd2F0Y2hGYWN0b3J5OiBXYXRjaEZhY3RvcnkgPSBuZXcgV2F0Y2hGYWN0b3J5KCk7XG5cbiAgcHVibGljIHJlZnJlc2goKSB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuICBwdWJsaWMgY3JlYXRlKF9jb21wb25lbnRBZGRlcjogVmlld0NvbXBvbmVudEFkZGVyKSB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuICBwdWJsaWMgcHJlbG9hZCgpIHtcbiAgICAvL2VtcHR5LCBjYW4gYmUgb3ZlcnJpZGVkIG9yIG5vdFxuICB9XG4gIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuXG4gIHB1YmxpYyBpbml0KGdhbWU6IFBoYXNlci5HYW1lLCBtb2RlbDogSU1vZGVsLCBnb1RvOiAoY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpID0+IHZvaWQpIHtcbiAgICBpZiAoIXRoaXMuaW5pdGlhdGVkKSB7XG4gICAgICB0aGlzLl9nYW1lID0gZ2FtZTtcbiAgICAgIHRoaXMuX21vZGVsID0gbW9kZWw7XG4gICAgICB0aGlzLl9nb1RvID0gZ29UbztcbiAgICAgIHRoaXMuY3JlYXRlVmlldygpO1xuICAgICAgdGhpcy5pbml0aWF0ZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGdldCBnYW1lKCk6IFBoYXNlci5HYW1lIHsgcmV0dXJuIHRoaXMuX2dhbWU7IH1cblxuICBnZXQgbW9kZWwoKTogSU1vZGVsIHsgcmV0dXJuIHRoaXMuX21vZGVsOyB9XG5cbiAgcHVibGljIGNyZWF0ZVZpZXcoKSB7XG4gICAgY29uc3QgY29tcG9uZW50QWRkZXIgPSBuZXcgVmlld0NvbXBvbmVudEFkZGVyKHRoaXMuY29tcG9uZW50cywgdGhpcyk7XG4gICAgdGhpcy5jcmVhdGUoY29tcG9uZW50QWRkZXIpO1xuICAgIHRoaXMudXBkYXRlT25Nb2RlbENoYW5nZSh0aGlzLndhdGNoRmFjdG9yeSk7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlVmlldygpIHtcbiAgICBpZiAoIXRoaXMuaW5pdGlhdGVkKSByZXR1cm47XG4gICAgdGhpcy5jaGVja1dhdGNoTW9kZWxzKCk7XG4gICAgdGhpcy51cGRhdGUoKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIGNvbXBvbmVudC51cGRhdGVDb21wb25lbnQoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcmVmcmVzaFZpZXcoKSB7XG4gICAgaWYgKCF0aGlzLmluaXRpYXRlZCkgdGhyb3cgRXZhbEVycm9yKCdWaWV3IGlzIG5vdCByZW5kZXJlZCBwbGVhc2UgcmVuZGVyIGl0IGJlZm9yZSByZWZyZXNoLicpO1xuICAgIHRoaXMucmVmcmVzaCgpO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZU9uTW9kZWxDaGFuZ2UoX3dhdGNoRmFjdG9yeTogV2F0Y2hGYWN0b3J5KXtcbiAgICAvL3RoaXMgc2hvdWxkIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tXYXRjaE1vZGVscygpe1xuICAgIGZvcihjb25zdCB3YXRjaE1vZGVsIG9mIHRoaXMud2F0Y2hGYWN0b3J5LndhdGNoc01vZGVsKXtcbiAgICAgIHdhdGNoTW9kZWwub2JzZXJ2ZXIubmV4dCh3YXRjaE1vZGVsLmdldE1vZGVsKCkpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBnb1RvKGNvbnRyb2xsZXJOYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJBY3Rpb246IHN0cmluZywgcGFyYW1zOiBJQWN0aW9uUGFyYW1zKTogdm9pZCB7XG4gICAgdGhpcy5fZ29Ubyhjb250cm9sbGVyTmFtZSwgY29udHJvbGxlckFjdGlvbiwgcGFyYW1zKTtcbiAgfVxufVxuXG4vKipcbiAqIENvbXBvbmVudCB0byBiZSBzaG93ZWQgaW4gdmlld1xuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVmlld0NvbXBvbmVudCB7XG4gIHB1YmxpYyB2aWV3OiBWaWV3O1xuICBwcm90ZWN0ZWQgY29tcG9uZW50czogVmlld0NvbXBvbmVudFtdID0gW107XG5cbiAgcHVibGljIGNyZWF0ZShfY29tcG9uZW50QWRkZXI6IFZpZXdDb21wb25lbnRBZGRlcik6IHZvaWQge1xuICAgIC8vZW1wdHksIGNhbiBiZSBvdmVycmlkZWQgb3Igbm90XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlKCk6IHZvaWQge1xuICAgIC8vZW1wdHksIGNhbiBiZSBvdmVycmlkZWQgb3Igbm90XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlQ29tcG9uZW50KGNvbXBvbmVudEFkZGVyOiBWaWV3Q29tcG9uZW50QWRkZXIsIHZpZXc6IFZpZXcpOiB2b2lkIHtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuY3JlYXRlKGNvbXBvbmVudEFkZGVyKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIGNvbXBvbmVudC5jcmVhdGVDb21wb25lbnQoY29tcG9uZW50QWRkZXIsIHZpZXcpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVDb21wb25lbnQoKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGUoKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIGNvbXBvbmVudC51cGRhdGVDb21wb25lbnQoKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IGdhbWUoKTogUGhhc2VyLkdhbWUge1xuICAgIHJldHVybiB0aGlzLnZpZXcuZ2FtZTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3ZpZXcudHMiLCJpbXBvcnQgeyBPYnNlcnZhYmxlLCBPYnNlcnZlciB9IGZyb20gJ0ByZWFjdGl2ZXgvcnhqcyc7XG5cbmV4cG9ydCBjbGFzcyBXYXRjaE1vZGVsPFQ+IHtcbiAgb2JzZXJ2YWJsZTogT2JzZXJ2YWJsZTxUPjtcbiAgb2JzZXJ2ZXI6IE9ic2VydmVyPCgpID0+IFQ+O1xuICBnZXRNb2RlbDogKCkgPT4gVDtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy93YXRjaF9tb2RlbC50cyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIkByZWFjdGl2ZXgvcnhqc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcIkByZWFjdGl2ZXgvcnhqc1wiXG4vLyBtb2R1bGUgaWQgPSA3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImxvZGFzaFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImxvZGFzaFwiXG4vLyBtb2R1bGUgaWQgPSA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=