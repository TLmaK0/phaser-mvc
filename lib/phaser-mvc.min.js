(function(e, a) { for(var i in a) e[i] = a[i]; }(exports, /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var bootstrap_1 = __webpack_require__(1);
exports.Bootstrap = bootstrap_1.Bootstrap;
var controller_1 = __webpack_require__(3);
exports.Controller = controller_1.Controller;
var view_1 = __webpack_require__(4);
exports.View = view_1.View;
exports.ViewComponent = view_1.ViewComponent;


/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

/**
 */
Object.defineProperty(exports, "__esModule", { value: true });
var Phaser = __webpack_require__(2);
/** Bootstrap for the phaser-mvc.
 * Useage:
 * import { FrameController } from 'phaser-mvc';
 * import { LandEditorController } from 'phaser-mvc';
 * window.onload = () => {
 * const boot = new Bootstrap();
 * boot.addController('FrameController', FrameController);
 */
var Bootstrap = /** @class */ (function () {
    function Bootstrap(width, height) {
        if (width === void 0) { width = 1920; }
        if (height === void 0) { height = 1080; }
        var _this = this;
        this.width = width;
        this.height = height;
        this.controllers = {};
        this.preload = function () {
            for (var _i = 0, _a = Bootstrap.preloadComponents; _i < _a.length; _i++) {
                var preload = _a[_i];
                preload(_this.game);
            }
        };
        this.create = function () {
            _this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            _this.goTo(_this.startAction[0], _this.startAction[1], _this.startAction[2]);
        };
        this.update = function () {
            for (var _i = 0, _a = Object.keys(_this.controllers); _i < _a.length; _i++) {
                var controllerName = _a[_i];
                _this.updateController(_this.controllers[controllerName]);
            }
        };
    }
    Bootstrap.preload = function (preload) {
        Bootstrap.preloadComponents.push(preload);
    };
    Bootstrap.prototype.start = function (controllerName, controllerAction, params) {
        this.startAction = [controllerName, controllerAction, params];
        this.game = new Phaser.Game(this.width, this.height, Phaser.CANVAS, 'content', { preload: this.preload,
            create: this.create,
            update: this.update });
    };
    Bootstrap.prototype.addController = function (name, controllerType) {
        if (this.controllers[name] != null)
            throw EvalError("Controller " + name + " already registered.");
        var controller = new controllerType();
        controller.bootstrap = this;
        this.controllers[name] = controller;
    };
    Bootstrap.prototype.goTo = function (controllerName, controllerAction, params) {
        /*tslint:disable:no-any*/
        var controller = this.controllers[controllerName];
        /*tslint:enable:no-any*/
        if (!controller) {
            throw EvalError("Controller " + controllerName + " not exist. Be sure you load it in bootstrap.");
        }
        /*tslint:disable:no-unsafe-any*/
        controller[controllerAction](params);
        /*tslint:enable:no-unsafe-any*/
    };
    Bootstrap.prototype.updateController = function (controller) {
        for (var _i = 0, _a = Object.keys(controller.views); _i < _a.length; _i++) {
            var viewName = _a[_i];
            controller.getView(viewName).updateView();
        }
    };
    Bootstrap.preloadComponents = [];
    return Bootstrap;
}());
exports.Bootstrap = Bootstrap;


/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = require("phaser-ce");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Controller accepts input from view and converts modifieds the model.
 */
var Controller = /** @class */ (function () {
    function Controller() {
        var _this = this;
        this.views = {};
        this.model = {};
        this.goTo = function (controllerName, controllerAction, params) {
            _this.bootstrap.goTo(controllerName, controllerAction, params);
        };
    }
    Object.defineProperty(Controller.prototype, "game", {
        get: function () {
            return this.bootstrap.game;
        },
        enumerable: true,
        configurable: true
    });
    Controller.prototype.getView = function (viewName) {
        var view = this.views[viewName];
        if (view == null) {
            throw EvalError("View " + viewName + " not exist. Be sure you have added it to your controller.");
        }
        return view;
    };
    Controller.prototype.render = function (view) {
        view.init(this.game, this.model, this.goTo);
    };
    Controller.prototype.refresh = function (view) {
        view.refresh();
    };
    return Controller;
}());
exports.Controller = Controller;


/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var _ = __webpack_require__(5);
var rxjs_1 = __webpack_require__(6);
var model_watch_1 = __webpack_require__(7);
/**
 * Adds a component to the view and other view components
 */
var ViewComponentAdder = /** @class */ (function () {
    function ViewComponentAdder(components, view) {
        this.components = components;
        this.view = view;
    }
    ViewComponentAdder.prototype.addComponent = function (component) {
        this.components.push(component);
        component.createComponent(this, this.view);
        return component;
    };
    return ViewComponentAdder;
}());
exports.ViewComponentAdder = ViewComponentAdder;
/**
 * Input and ouput for the application
 */
var View = /** @class */ (function () {
    function View() {
        var _this = this;
        this.components = [];
        this.initiated = false;
        this.modelWatchs = [];
        this.execOnUpdated = function (getModel, returnModel, update) {
            var modelWatch = new model_watch_1.ModelWatch();
            modelWatch.observable = rxjs_1.Observable.create(function (observer) { return modelWatch.observer = observer; }).distinctUntilChanged(function (prev, next) { return _.isEqual(prev, next); }).map(function (model) {
                var model = returnModel(model);
                return model;
            });
            modelWatch.getModel = getModel;
            modelWatch.observable.subscribe(update);
            _this.modelWatchs.push(modelWatch);
        };
    }
    View.prototype.refresh = function () {
        //empty, can be overrided or not
    };
    View.prototype.create = function (_componentAdder) {
        //empty, can be overrided or not
    };
    View.prototype.preload = function () {
        //empty, can be overrided or not
    };
    View.prototype.update = function () {
        //empty, can be overrided or not
    };
    View.prototype.init = function (game, model, goTo) {
        if (!this.initiated) {
            this._game = game;
            this._model = model;
            this._goTo = goTo;
            this.createView();
            this.initiated = true;
        }
    };
    Object.defineProperty(View.prototype, "game", {
        get: function () { return this._game; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "model", {
        get: function () { return this._model; },
        enumerable: true,
        configurable: true
    });
    View.prototype.createView = function () {
        var componentAdder = new ViewComponentAdder(this.components, this);
        this.create(componentAdder);
        this.updateOnModelChange(this.execOnUpdated);
    };
    View.prototype.updateView = function () {
        if (!this.initiated)
            return;
        this.checkModelWatchs();
        this.update();
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.updateComponent();
        }
    };
    View.prototype.refreshView = function () {
        if (!this.initiated)
            throw EvalError('View is not rendered please render it before refresh.');
        this.refresh();
    };
    View.prototype.updateOnModelChange = function (_onChange) {
        //this should be overrided or not
    };
    View.prototype.checkModelWatchs = function () {
        for (var _i = 0, _a = this.modelWatchs; _i < _a.length; _i++) {
            var modelWatch = _a[_i];
            modelWatch.observer.next(modelWatch.getModel(this.model));
        }
    };
    View.prototype.goTo = function (controllerName, controllerAction, params) {
        this._goTo(controllerName, controllerAction, params);
    };
    return View;
}());
exports.View = View;
/**
 * Component to be showed in view
 */
var ViewComponent = /** @class */ (function () {
    function ViewComponent() {
        this.components = [];
    }
    ViewComponent.prototype.create = function (_componentAdder) {
        //empty, can be overrided or not
    };
    ViewComponent.prototype.update = function () {
        //empty, can be overrided or not
    };
    ViewComponent.prototype.createComponent = function (componentAdder, view) {
        this.view = view;
        this.create(componentAdder);
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.createComponent(componentAdder, view);
        }
    };
    ViewComponent.prototype.updateComponent = function () {
        this.update();
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.updateComponent();
        }
    };
    Object.defineProperty(ViewComponent.prototype, "game", {
        get: function () {
            return this.view.game;
        },
        enumerable: true,
        configurable: true
    });
    return ViewComponent;
}());
exports.ViewComponent = ViewComponent;


/***/ }),
/* 5 */
/***/ (function(module, exports) {

module.exports = require("lodash");

/***/ }),
/* 6 */
/***/ (function(module, exports) {

module.exports = require("@reactivex/rxjs");

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ModelWatch = /** @class */ (function () {
    function ModelWatch() {
    }
    return ModelWatch;
}());
exports.ModelWatch = ModelWatch;


/***/ })
/******/ ])));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgZmM4MjQ0YTI2ZTY4ZjI3NzJmNjkiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9ib290c3RyYXAudHMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicGhhc2VyLWNlXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnRyb2xsZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXcudHMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwibG9kYXNoXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiQHJlYWN0aXZleC9yeGpzXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZGVsX3dhdGNoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQTJCLDBCQUEwQixFQUFFO0FBQ3ZELHlDQUFpQyxlQUFlO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUFzRCwrREFBK0Q7O0FBRXJIO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7OztBQzdEQSx5Q0FBd0M7QUFBL0IseUNBQVM7QUFDbEIsMENBQTBDO0FBQWpDLDRDQUFVO0FBQ25CLG9DQUE2QztBQUFwQywwQkFBSTtBQUFFLDRDQUFhOzs7Ozs7Ozs7QUNGNUI7R0FDRzs7QUFFSCxvQ0FBb0M7QUFNcEM7Ozs7Ozs7R0FPRztBQUVIO0lBT0UsbUJBQTBCLEtBQW9CLEVBQVMsTUFBcUI7UUFBbEQsb0NBQW9CO1FBQVMsc0NBQXFCO1FBQTVFLGlCQUNDO1FBRHlCLFVBQUssR0FBTCxLQUFLLENBQWU7UUFBUyxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBSGxFLGdCQUFXLEdBQW1CLEVBQUUsQ0FBQztRQXNCcEMsWUFBTyxHQUFHO1lBQ2YsR0FBRyxDQUFDLENBQWtCLFVBQTJCLEVBQTNCLGNBQVMsQ0FBQyxpQkFBaUIsRUFBM0IsY0FBMkIsRUFBM0IsSUFBMkI7Z0JBQTVDLElBQU0sT0FBTztnQkFDaEIsT0FBTyxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNwQjtRQUNILENBQUM7UUFFTSxXQUFNLEdBQUc7WUFDZCxLQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUM7WUFDekQsS0FBSSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNFLENBQUM7UUFFTSxXQUFNLEdBQUc7WUFDZCxHQUFHLENBQUMsQ0FBeUIsVUFBNkIsRUFBN0IsV0FBTSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsV0FBVyxDQUFDLEVBQTdCLGNBQTZCLEVBQTdCLElBQTZCO2dCQUFyRCxJQUFNLGNBQWM7Z0JBQ3ZCLEtBQUksQ0FBQyxnQkFBZ0IsQ0FBYSxLQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7YUFDckU7UUFDSCxDQUFDO0lBakNELENBQUM7SUFFYSxpQkFBTyxHQUFyQixVQUFzQixPQUFvQztRQUN4RCxTQUFTLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFTSx5QkFBSyxHQUFaLFVBQWEsY0FBc0IsRUFBRSxnQkFBd0IsRUFBRSxNQUFxQjtRQUNsRixJQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsY0FBYyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzlELElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUN6QixJQUFJLENBQUMsS0FBSyxFQUNWLElBQUksQ0FBQyxNQUFNLEVBQ1gsTUFBTSxDQUFDLE1BQU0sRUFDYixTQUFTLEVBQ1QsRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU87WUFDckIsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNO1lBQ25CLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFDLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBbUJNLGlDQUFhLEdBQXBCLFVBQTJDLElBQVksRUFBRSxjQUEyQjtRQUNsRixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQztZQUFDLE1BQU0sU0FBUyxDQUFDLGdCQUFjLElBQUkseUJBQXNCLENBQUMsQ0FBQztRQUU5RixJQUFNLFVBQVUsR0FBTSxJQUFJLGNBQWMsRUFBRSxDQUFDO1FBQzNDLFVBQVUsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQzVCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsVUFBVSxDQUFDO0lBQ3RDLENBQUM7SUFFTSx3QkFBSSxHQUFYLFVBQVksY0FBc0IsRUFBRSxnQkFBd0IsRUFBRSxNQUFxQjtRQUNqRix5QkFBeUI7UUFDekIsSUFBTSxVQUFVLEdBQVEsSUFBSSxDQUFDLFdBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUN6RCx3QkFBd0I7UUFDeEIsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1lBQ2hCLE1BQU0sU0FBUyxDQUFDLGdCQUFjLGNBQWMsa0RBQStDLENBQUMsQ0FBQztRQUMvRixDQUFDO1FBQ0QsZ0NBQWdDO1FBQ2hDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JDLCtCQUErQjtJQUNqQyxDQUFDO0lBRU8sb0NBQWdCLEdBQXhCLFVBQXlCLFVBQXNCO1FBQzdDLEdBQUcsQ0FBQyxDQUFtQixVQUE2QixFQUE3QixXQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsRUFBN0IsY0FBNkIsRUFBN0IsSUFBNkI7WUFBL0MsSUFBTSxRQUFRO1lBQ2pCLFVBQVUsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7U0FDM0M7SUFDSCxDQUFDO0lBbEVjLDJCQUFpQixHQUFvQyxFQUFFLENBQUM7SUFtRXpFLGdCQUFDO0NBQUE7QUFwRVksOEJBQVM7Ozs7Ozs7QUNsQnRCLHNDOzs7Ozs7Ozs7QUNTQTs7R0FFRztBQUNIO0lBQUE7UUFBQSxpQkE2QkM7UUE1QlEsVUFBSyxHQUFhLEVBQUUsQ0FBQztRQUVyQixVQUFLLEdBQVcsRUFBRSxDQUFDO1FBTW5CLFNBQUksR0FBRyxVQUFDLGNBQXNCLEVBQUUsZ0JBQXdCLEVBQUUsTUFBcUI7WUFDcEYsS0FBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ2hFLENBQUM7SUFrQkgsQ0FBQztJQXhCQyxzQkFBVyw0QkFBSTthQUFmO1lBQ0UsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDO1FBQzdCLENBQUM7OztPQUFBO0lBTU0sNEJBQU8sR0FBZCxVQUFlLFFBQWdCO1FBQzdCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEMsRUFBRSxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDakIsTUFBTSxTQUFTLENBQUMsVUFBUSxRQUFRLDhEQUEyRCxDQUFDLENBQUM7UUFDL0YsQ0FBQztRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRVMsMkJBQU0sR0FBaEIsVUFBaUIsSUFBVTtRQUN6QixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUVTLDRCQUFPLEdBQWpCLFVBQWtCLElBQVU7UUFDMUIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2pCLENBQUM7SUFDSCxpQkFBQztBQUFELENBQUM7QUE3QnFCLGdDQUFVOzs7Ozs7Ozs7O0FDWGhDLCtCQUE0QjtBQUM1QixvQ0FBdUQ7QUFJdkQsMkNBQXFEO0FBRXJEOztHQUVHO0FBQ0g7SUFDRSw0QkFBb0IsVUFBMkIsRUFBVSxJQUFVO1FBQS9DLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQVUsU0FBSSxHQUFKLElBQUksQ0FBTTtJQUFHLENBQUM7SUFFaEUseUNBQVksR0FBbkIsVUFBNkMsU0FBWTtRQUN2RCxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNoQyxTQUFTLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFM0MsTUFBTSxDQUFDLFNBQVMsQ0FBQztJQUNuQixDQUFDO0lBQ0gseUJBQUM7QUFBRCxDQUFDO0FBVFksZ0RBQWtCO0FBYS9COztHQUVHO0FBQ0g7SUFBQTtRQUFBLGlCQXNGQztRQXJGVyxlQUFVLEdBQW9CLEVBQUUsQ0FBQztRQUNqQyxjQUFTLEdBQVksS0FBSyxDQUFDO1FBd0Q3QixnQkFBVyxHQUFpQixFQUFFLENBQUM7UUFFL0Isa0JBQWEsR0FBRyxVQUFDLFFBQWtCLEVBQUUsV0FBcUIsRUFBRSxNQUFnQjtZQUNsRixJQUFNLFVBQVUsR0FBRyxJQUFJLHdCQUFVLEVBQUUsQ0FBQztZQUVwQyxVQUFVLENBQUMsVUFBVSxHQUFHLGlCQUFVLENBQUMsTUFBTSxDQUN2QyxVQUFDLFFBQTRCLElBQUssaUJBQVUsQ0FBQyxRQUFRLEdBQUcsUUFBUSxFQUE5QixDQUE4QixDQUNqRSxDQUFDLG9CQUFvQixDQUNwQixVQUFDLElBQVMsRUFBRSxJQUFTLElBQUssUUFBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQXJCLENBQXFCLENBQ2hELENBQUMsR0FBRyxDQUFDLFVBQUMsS0FBVTtnQkFDZixJQUFJLEtBQUssR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQy9CLE1BQU0sQ0FBQyxLQUFLLENBQUM7WUFDZixDQUFDLENBQUMsQ0FBQztZQUVILFVBQVUsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1lBQy9CLFVBQVUsQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3hDLEtBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3BDLENBQUM7SUFXSCxDQUFDO0lBL0VRLHNCQUFPLEdBQWQ7UUFDRSxnQ0FBZ0M7SUFDbEMsQ0FBQztJQUNNLHFCQUFNLEdBQWIsVUFBYyxlQUFtQztRQUMvQyxnQ0FBZ0M7SUFDbEMsQ0FBQztJQUNNLHNCQUFPLEdBQWQ7UUFDRSxnQ0FBZ0M7SUFDbEMsQ0FBQztJQUNNLHFCQUFNLEdBQWI7UUFDRSxnQ0FBZ0M7SUFDbEMsQ0FBQztJQUVNLG1CQUFJLEdBQVgsVUFBWSxJQUFpQixFQUFFLEtBQWEsRUFBRSxJQUF1RjtRQUNuSSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQ3BCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1lBQ2xCLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1lBQ3BCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1lBQ2xCLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNsQixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUN4QixDQUFDO0lBQ0gsQ0FBQztJQUVELHNCQUFJLHNCQUFJO2FBQVIsY0FBMEIsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDOzs7T0FBQTtJQUU5QyxzQkFBSSx1QkFBSzthQUFULGNBQXNCLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQzs7O09BQUE7SUFFcEMseUJBQVUsR0FBakI7UUFDRSxJQUFNLGNBQWMsR0FBRyxJQUFJLGtCQUFrQixDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDckUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUM1QixJQUFJLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFTSx5QkFBVSxHQUFqQjtRQUNFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUFDLE1BQU0sQ0FBQztRQUM1QixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDZCxHQUFHLENBQUMsQ0FBb0IsVUFBZSxFQUFmLFNBQUksQ0FBQyxVQUFVLEVBQWYsY0FBZSxFQUFmLElBQWU7WUFBbEMsSUFBTSxTQUFTO1lBQ2xCLFNBQVMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztTQUM3QjtJQUNILENBQUM7SUFFTSwwQkFBVyxHQUFsQjtRQUNFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUFDLE1BQU0sU0FBUyxDQUFDLHVEQUF1RCxDQUFDLENBQUM7UUFDOUYsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2pCLENBQUM7SUFFTSxrQ0FBbUIsR0FBMUIsVUFBMkIsU0FBK0I7UUFDeEQsaUNBQWlDO0lBQ25DLENBQUM7SUFxQk8sK0JBQWdCLEdBQXhCO1FBQ0UsR0FBRyxFQUFxQixVQUFnQixFQUFoQixTQUFJLENBQUMsV0FBVyxFQUFoQixjQUFnQixFQUFoQixJQUFnQjtZQUFwQyxJQUFNLFVBQVU7WUFDbEIsVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUMzRDtJQUNILENBQUM7SUFFUyxtQkFBSSxHQUFkLFVBQWUsY0FBc0IsRUFBRSxnQkFBd0IsRUFBRSxNQUFxQjtRQUNwRixJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBQ0gsV0FBQztBQUFELENBQUM7QUF0RnFCLG9CQUFJO0FBd0YxQjs7R0FFRztBQUNIO0lBQUE7UUFFWSxlQUFVLEdBQW9CLEVBQUUsQ0FBQztJQTRCN0MsQ0FBQztJQTFCUSw4QkFBTSxHQUFiLFVBQWMsZUFBbUM7UUFDL0MsZ0NBQWdDO0lBQ2xDLENBQUM7SUFFTSw4QkFBTSxHQUFiO1FBQ0UsZ0NBQWdDO0lBQ2xDLENBQUM7SUFFTSx1Q0FBZSxHQUF0QixVQUF1QixjQUFrQyxFQUFFLElBQVU7UUFDbkUsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUM1QixHQUFHLENBQUMsQ0FBb0IsVUFBZSxFQUFmLFNBQUksQ0FBQyxVQUFVLEVBQWYsY0FBZSxFQUFmLElBQWU7WUFBbEMsSUFBTSxTQUFTO1lBQ2xCLFNBQVMsQ0FBQyxlQUFlLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQ2pEO0lBQ0gsQ0FBQztJQUVNLHVDQUFlLEdBQXRCO1FBQ0UsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2QsR0FBRyxDQUFDLENBQW9CLFVBQWUsRUFBZixTQUFJLENBQUMsVUFBVSxFQUFmLGNBQWUsRUFBZixJQUFlO1lBQWxDLElBQU0sU0FBUztZQUNsQixTQUFTLENBQUMsZUFBZSxFQUFFLENBQUM7U0FDN0I7SUFDSCxDQUFDO0lBRUQsc0JBQWMsK0JBQUk7YUFBbEI7WUFDRSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDeEIsQ0FBQzs7O09BQUE7SUFDSCxvQkFBQztBQUFELENBQUM7QUE5QnFCLHNDQUFhOzs7Ozs7O0FDdEhuQyxtQzs7Ozs7O0FDQUEsNEM7Ozs7Ozs7OztBQ0lBO0lBQUE7SUFJQSxDQUFDO0lBQUQsaUJBQUM7QUFBRCxDQUFDO0FBSlksZ0NBQVUiLCJmaWxlIjoicGhhc2VyLW12Yy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCBmYzgyNDRhMjZlNjhmMjc3MmY2OSIsImV4cG9ydCB7IEJvb3RzdHJhcCB9IGZyb20gJy4vYm9vdHN0cmFwJztcbmV4cG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICcuL2NvbnRyb2xsZXInO1xuZXhwb3J0IHsgVmlldywgVmlld0NvbXBvbmVudCB9IGZyb20gJy4vdmlldyc7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXgudHMiLCIvKipcbiAqL1xuXG5pbXBvcnQgKiBhcyBQaGFzZXIgZnJvbSAncGhhc2VyLWNlJztcblxuaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJy4vY29udHJvbGxlcic7XG5pbXBvcnQgeyBJQWN0aW9uUGFyYW1zIH0gZnJvbSAnLi9pX2FjdGlvbl9wYXJhbXMnO1xuaW1wb3J0IHsgSUNvbnRyb2xsZXJNYXAgfSBmcm9tICcuL2lfY29udHJvbGxlcl9tYXAnO1xuXG4vKiogQm9vdHN0cmFwIGZvciB0aGUgcGhhc2VyLW12Yy5cbiAqIFVzZWFnZTpcbiAqIGltcG9ydCB7IEZyYW1lQ29udHJvbGxlciB9IGZyb20gJ3BoYXNlci1tdmMnO1xuICogaW1wb3J0IHsgTGFuZEVkaXRvckNvbnRyb2xsZXIgfSBmcm9tICdwaGFzZXItbXZjJztcbiAqIHdpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gKiBjb25zdCBib290ID0gbmV3IEJvb3RzdHJhcCgpO1xuICogYm9vdC5hZGRDb250cm9sbGVyKCdGcmFtZUNvbnRyb2xsZXInLCBGcmFtZUNvbnRyb2xsZXIpO1xuICovXG5cbmV4cG9ydCBjbGFzcyBCb290c3RyYXAge1xuICBwcml2YXRlIHN0YXRpYyBwcmVsb2FkQ29tcG9uZW50czogKChnYW1lOiBQaGFzZXIuR2FtZSkgPT4gdm9pZClbXSA9IFtdO1xuXG4gIHB1YmxpYyBnYW1lOiBQaGFzZXIuR2FtZTtcbiAgcHJvdGVjdGVkIGNvbnRyb2xsZXJzOiBJQ29udHJvbGxlck1hcCA9IHt9O1xuICBwcml2YXRlIHN0YXJ0QWN0aW9uOiBbc3RyaW5nLCBzdHJpbmcsIElBY3Rpb25QYXJhbXNdO1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihwdWJsaWMgd2lkdGg6IG51bWJlciA9IDE5MjAsIHB1YmxpYyBoZWlnaHQ6IG51bWJlciA9IDEwODApe1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBwcmVsb2FkKHByZWxvYWQ6IChnYW1lOiBQaGFzZXIuR2FtZSkgPT4gdm9pZCk6IHZvaWQge1xuICAgIEJvb3RzdHJhcC5wcmVsb2FkQ29tcG9uZW50cy5wdXNoKHByZWxvYWQpO1xuICB9XG5cbiAgcHVibGljIHN0YXJ0KGNvbnRyb2xsZXJOYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJBY3Rpb246IHN0cmluZywgcGFyYW1zOiBJQWN0aW9uUGFyYW1zKTogdm9pZCB7XG4gICAgdGhpcy5zdGFydEFjdGlvbiA9IFtjb250cm9sbGVyTmFtZSwgY29udHJvbGxlckFjdGlvbiwgcGFyYW1zXTtcbiAgICB0aGlzLmdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoXG4gICAgICB0aGlzLndpZHRoLFxuICAgICAgdGhpcy5oZWlnaHQsXG4gICAgICBQaGFzZXIuQ0FOVkFTLFxuICAgICAgJ2NvbnRlbnQnLFxuICAgICAgeyBwcmVsb2FkOiB0aGlzLnByZWxvYWQsXG4gICAgICAgIGNyZWF0ZTogdGhpcy5jcmVhdGUsXG4gICAgICAgIHVwZGF0ZTogdGhpcy51cGRhdGV9KTtcbiAgfVxuXG4gIHB1YmxpYyBwcmVsb2FkID0gKCk6IHZvaWQgPT4ge1xuICAgIGZvciAoY29uc3QgcHJlbG9hZCBvZiBCb290c3RyYXAucHJlbG9hZENvbXBvbmVudHMpIHtcbiAgICAgIHByZWxvYWQodGhpcy5nYW1lKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlID0gKCk6IHZvaWQgPT4ge1xuICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgIHRoaXMuZ29Ubyh0aGlzLnN0YXJ0QWN0aW9uWzBdLCB0aGlzLnN0YXJ0QWN0aW9uWzFdLCB0aGlzLnN0YXJ0QWN0aW9uWzJdKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGUgPSAoKTogdm9pZCA9PiB7XG4gICAgZm9yIChjb25zdCBjb250cm9sbGVyTmFtZSBvZiBPYmplY3Qua2V5cyh0aGlzLmNvbnRyb2xsZXJzKSkge1xuICAgICAgdGhpcy51cGRhdGVDb250cm9sbGVyKDxDb250cm9sbGVyPnRoaXMuY29udHJvbGxlcnNbY29udHJvbGxlck5hbWVdKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgYWRkQ29udHJvbGxlcjxUIGV4dGVuZHMgQ29udHJvbGxlcj4obmFtZTogc3RyaW5nLCBjb250cm9sbGVyVHlwZTogbmV3ICgpID0+IFQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb250cm9sbGVyc1tuYW1lXSAhPSBudWxsKSB0aHJvdyBFdmFsRXJyb3IoYENvbnRyb2xsZXIgJHtuYW1lfSBhbHJlYWR5IHJlZ2lzdGVyZWQuYCk7XG5cbiAgICBjb25zdCBjb250cm9sbGVyOiBUID0gbmV3IGNvbnRyb2xsZXJUeXBlKCk7XG4gICAgY29udHJvbGxlci5ib290c3RyYXAgPSB0aGlzO1xuICAgIHRoaXMuY29udHJvbGxlcnNbbmFtZV0gPSBjb250cm9sbGVyO1xuICB9XG5cbiAgcHVibGljIGdvVG8oY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpOiB2b2lkIHtcbiAgICAvKnRzbGludDpkaXNhYmxlOm5vLWFueSovXG4gICAgY29uc3QgY29udHJvbGxlcjogYW55ID0gdGhpcy5jb250cm9sbGVyc1tjb250cm9sbGVyTmFtZV07XG4gICAgLyp0c2xpbnQ6ZW5hYmxlOm5vLWFueSovXG4gICAgaWYgKCFjb250cm9sbGVyKSB7XG4gICAgICB0aHJvdyBFdmFsRXJyb3IoYENvbnRyb2xsZXIgJHtjb250cm9sbGVyTmFtZX0gbm90IGV4aXN0LiBCZSBzdXJlIHlvdSBsb2FkIGl0IGluIGJvb3RzdHJhcC5gKTtcbiAgICB9XG4gICAgLyp0c2xpbnQ6ZGlzYWJsZTpuby11bnNhZmUtYW55Ki9cbiAgICBjb250cm9sbGVyW2NvbnRyb2xsZXJBY3Rpb25dKHBhcmFtcyk7XG4gICAgLyp0c2xpbnQ6ZW5hYmxlOm5vLXVuc2FmZS1hbnkqL1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVDb250cm9sbGVyKGNvbnRyb2xsZXI6IENvbnRyb2xsZXIpOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IHZpZXdOYW1lIG9mIE9iamVjdC5rZXlzKGNvbnRyb2xsZXIudmlld3MpKSB7XG4gICAgICBjb250cm9sbGVyLmdldFZpZXcodmlld05hbWUpLnVwZGF0ZVZpZXcoKTtcbiAgICB9XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9ib290c3RyYXAudHMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJwaGFzZXItY2VcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJwaGFzZXItY2VcIlxuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyBQaGFzZXIgZnJvbSAncGhhc2VyLWNlJztcblxuaW1wb3J0IHsgQm9vdHN0cmFwIH0gZnJvbSAnLi9ib290c3RyYXAnO1xuaW1wb3J0IHsgSUFjdGlvblBhcmFtcyB9IGZyb20gJy4vaV9hY3Rpb25fcGFyYW1zJztcbmltcG9ydCB7IElDb250cm9sbGVyTWFwIH0gZnJvbSAnLi9pX2NvbnRyb2xsZXJfbWFwJztcbmltcG9ydCB7IElNb2RlbCB9IGZyb20gJy4vaV9tb2RlbCc7XG5pbXBvcnQgeyBJVmlld01hcCB9IGZyb20gJy4vaV92aWV3X21hcCc7XG5pbXBvcnQgeyBWaWV3IH0gZnJvbSAnLi92aWV3JztcblxuLyoqXG4gKiBDb250cm9sbGVyIGFjY2VwdHMgaW5wdXQgZnJvbSB2aWV3IGFuZCBjb252ZXJ0cyBtb2RpZmllZHMgdGhlIG1vZGVsLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29udHJvbGxlciB7XG4gIHB1YmxpYyB2aWV3czogSVZpZXdNYXAgPSB7fTtcbiAgcHVibGljIGJvb3RzdHJhcDogQm9vdHN0cmFwO1xuICBwdWJsaWMgbW9kZWw6IElNb2RlbCA9IHt9O1xuXG4gIHB1YmxpYyBnZXQgZ2FtZSgpOiBQaGFzZXIuR2FtZSB7XG4gICAgcmV0dXJuIHRoaXMuYm9vdHN0cmFwLmdhbWU7XG4gIH1cblxuICBwdWJsaWMgZ29UbyA9IChjb250cm9sbGVyTmFtZTogc3RyaW5nLCBjb250cm9sbGVyQWN0aW9uOiBzdHJpbmcsIHBhcmFtczogSUFjdGlvblBhcmFtcykgPT4ge1xuICAgIHRoaXMuYm9vdHN0cmFwLmdvVG8oY29udHJvbGxlck5hbWUsIGNvbnRyb2xsZXJBY3Rpb24sIHBhcmFtcyk7XG4gIH1cblxuICBwdWJsaWMgZ2V0Vmlldyh2aWV3TmFtZTogc3RyaW5nKTogVmlldyB7XG4gICAgY29uc3QgdmlldyA9IHRoaXMudmlld3Nbdmlld05hbWVdO1xuICAgIGlmICh2aWV3ID09IG51bGwpIHtcbiAgICAgIHRocm93IEV2YWxFcnJvcihgVmlldyAke3ZpZXdOYW1lfSBub3QgZXhpc3QuIEJlIHN1cmUgeW91IGhhdmUgYWRkZWQgaXQgdG8geW91ciBjb250cm9sbGVyLmApO1xuICAgIH1cblxuICAgIHJldHVybiB2aWV3O1xuICB9XG5cbiAgcHJvdGVjdGVkIHJlbmRlcih2aWV3OiBWaWV3KTogdm9pZCB7XG4gICAgdmlldy5pbml0KHRoaXMuZ2FtZSwgdGhpcy5tb2RlbCwgdGhpcy5nb1RvKTtcbiAgfVxuXG4gIHByb3RlY3RlZCByZWZyZXNoKHZpZXc6IFZpZXcpOiB2b2lkIHtcbiAgICB2aWV3LnJlZnJlc2goKTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbnRyb2xsZXIudHMiLCJpbXBvcnQgKiBhcyBQaGFzZXIgZnJvbSAncGhhc2VyLWNlJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IE9ic2VydmFibGUsIE9ic2VydmVyIH0gZnJvbSAnQHJlYWN0aXZleC9yeGpzJztcblxuaW1wb3J0IHsgSUFjdGlvblBhcmFtcyB9IGZyb20gJy4vaV9hY3Rpb25fcGFyYW1zJztcbmltcG9ydCB7IElNb2RlbCB9IGZyb20gJy4vaV9tb2RlbCc7XG5pbXBvcnQgeyBNb2RlbFdhdGNoLCBHZXRNb2RlbCB9IGZyb20gJy4vbW9kZWxfd2F0Y2gnO1xuXG4vKipcbiAqIEFkZHMgYSBjb21wb25lbnQgdG8gdGhlIHZpZXcgYW5kIG90aGVyIHZpZXcgY29tcG9uZW50c1xuICovXG5leHBvcnQgY2xhc3MgVmlld0NvbXBvbmVudEFkZGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjb21wb25lbnRzOiBWaWV3Q29tcG9uZW50W10sIHByaXZhdGUgdmlldzogVmlldykge31cblxuICBwdWJsaWMgYWRkQ29tcG9uZW50PFQgZXh0ZW5kcyBWaWV3Q29tcG9uZW50Pihjb21wb25lbnQ6IFQpOiBUIHtcbiAgICB0aGlzLmNvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgIGNvbXBvbmVudC5jcmVhdGVDb21wb25lbnQodGhpcywgdGhpcy52aWV3KTtcblxuICAgIHJldHVybiBjb21wb25lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgRXhlY3V0ZU9uTW9kZWxDaGFuZ2UgPSAoZ2V0TW9kZWw6IEdldE1vZGVsLCByZXR1cm5Nb2RlbDogR2V0TW9kZWwsIHVwZGF0ZTogR2V0TW9kZWwgKSA9PiB2b2lkO1xuXG4vKipcbiAqIElucHV0IGFuZCBvdXB1dCBmb3IgdGhlIGFwcGxpY2F0aW9uXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBWaWV3IHtcbiAgcHJvdGVjdGVkIGNvbXBvbmVudHM6IFZpZXdDb21wb25lbnRbXSA9IFtdO1xuICBwcm90ZWN0ZWQgaW5pdGlhdGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgX2dhbWU6IFBoYXNlci5HYW1lO1xuICBwcml2YXRlIF9tb2RlbDogSU1vZGVsO1xuICBwcml2YXRlIF9nb1RvOiAoY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpID0+IHZvaWQ7XG5cbiAgcHVibGljIHJlZnJlc2goKSB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuICBwdWJsaWMgY3JlYXRlKF9jb21wb25lbnRBZGRlcjogVmlld0NvbXBvbmVudEFkZGVyKSB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuICBwdWJsaWMgcHJlbG9hZCgpIHtcbiAgICAvL2VtcHR5LCBjYW4gYmUgb3ZlcnJpZGVkIG9yIG5vdFxuICB9XG4gIHB1YmxpYyB1cGRhdGUoKSB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuXG4gIHB1YmxpYyBpbml0KGdhbWU6IFBoYXNlci5HYW1lLCBtb2RlbDogSU1vZGVsLCBnb1RvOiAoY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpID0+IHZvaWQpIHtcbiAgICBpZiAoIXRoaXMuaW5pdGlhdGVkKSB7XG4gICAgICB0aGlzLl9nYW1lID0gZ2FtZTtcbiAgICAgIHRoaXMuX21vZGVsID0gbW9kZWw7XG4gICAgICB0aGlzLl9nb1RvID0gZ29UbztcbiAgICAgIHRoaXMuY3JlYXRlVmlldygpO1xuICAgICAgdGhpcy5pbml0aWF0ZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGdldCBnYW1lKCk6IFBoYXNlci5HYW1lIHsgcmV0dXJuIHRoaXMuX2dhbWU7IH1cblxuICBnZXQgbW9kZWwoKTogSU1vZGVsIHsgcmV0dXJuIHRoaXMuX21vZGVsOyB9XG5cbiAgcHVibGljIGNyZWF0ZVZpZXcoKSB7XG4gICAgY29uc3QgY29tcG9uZW50QWRkZXIgPSBuZXcgVmlld0NvbXBvbmVudEFkZGVyKHRoaXMuY29tcG9uZW50cywgdGhpcyk7XG4gICAgdGhpcy5jcmVhdGUoY29tcG9uZW50QWRkZXIpO1xuICAgIHRoaXMudXBkYXRlT25Nb2RlbENoYW5nZSh0aGlzLmV4ZWNPblVwZGF0ZWQpO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZVZpZXcoKSB7XG4gICAgaWYgKCF0aGlzLmluaXRpYXRlZCkgcmV0dXJuO1xuICAgIHRoaXMuY2hlY2tNb2RlbFdhdGNocygpO1xuICAgIHRoaXMudXBkYXRlKCk7XG4gICAgZm9yIChjb25zdCBjb21wb25lbnQgb2YgdGhpcy5jb21wb25lbnRzKSB7XG4gICAgICBjb21wb25lbnQudXBkYXRlQ29tcG9uZW50KCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHJlZnJlc2hWaWV3KCkge1xuICAgIGlmICghdGhpcy5pbml0aWF0ZWQpIHRocm93IEV2YWxFcnJvcignVmlldyBpcyBub3QgcmVuZGVyZWQgcGxlYXNlIHJlbmRlciBpdCBiZWZvcmUgcmVmcmVzaC4nKTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVPbk1vZGVsQ2hhbmdlKF9vbkNoYW5nZTogRXhlY3V0ZU9uTW9kZWxDaGFuZ2Upe1xuICAgIC8vdGhpcyBzaG91bGQgYmUgb3ZlcnJpZGVkIG9yIG5vdFxuICB9XG5cbiAgcHJpdmF0ZSBtb2RlbFdhdGNoczogTW9kZWxXYXRjaFtdID0gW107XG5cbiAgcHJpdmF0ZSBleGVjT25VcGRhdGVkID0gKGdldE1vZGVsOiBHZXRNb2RlbCwgcmV0dXJuTW9kZWw6IEdldE1vZGVsLCB1cGRhdGU6IEdldE1vZGVsICkgPT4ge1xuICAgIGNvbnN0IG1vZGVsV2F0Y2ggPSBuZXcgTW9kZWxXYXRjaCgpO1xuXG4gICAgbW9kZWxXYXRjaC5vYnNlcnZhYmxlID0gT2JzZXJ2YWJsZS5jcmVhdGUoXG4gICAgICAob2JzZXJ2ZXI6IE9ic2VydmVyPEdldE1vZGVsPikgPT4gbW9kZWxXYXRjaC5vYnNlcnZlciA9IG9ic2VydmVyXG4gICAgKS5kaXN0aW5jdFVudGlsQ2hhbmdlZChcbiAgICAgIChwcmV2OiBhbnksIG5leHQ6IGFueSkgPT4gXy5pc0VxdWFsKHByZXYsIG5leHQpXG4gICAgKS5tYXAoKG1vZGVsOiBhbnkpID0+IHtcbiAgICAgIGxldCBtb2RlbCA9IHJldHVybk1vZGVsKG1vZGVsKTtcbiAgICAgIHJldHVybiBtb2RlbDtcbiAgICB9KTtcblxuICAgIG1vZGVsV2F0Y2guZ2V0TW9kZWwgPSBnZXRNb2RlbDtcbiAgICBtb2RlbFdhdGNoLm9ic2VydmFibGUuc3Vic2NyaWJlKHVwZGF0ZSk7XG4gICAgdGhpcy5tb2RlbFdhdGNocy5wdXNoKG1vZGVsV2F0Y2gpOyBcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tNb2RlbFdhdGNocygpe1xuICAgIGZvcihjb25zdCBtb2RlbFdhdGNoIG9mIHRoaXMubW9kZWxXYXRjaHMpe1xuICAgICAgbW9kZWxXYXRjaC5vYnNlcnZlci5uZXh0KG1vZGVsV2F0Y2guZ2V0TW9kZWwodGhpcy5tb2RlbCkpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBnb1RvKGNvbnRyb2xsZXJOYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJBY3Rpb246IHN0cmluZywgcGFyYW1zOiBJQWN0aW9uUGFyYW1zKTogdm9pZCB7XG4gICAgdGhpcy5fZ29Ubyhjb250cm9sbGVyTmFtZSwgY29udHJvbGxlckFjdGlvbiwgcGFyYW1zKTtcbiAgfVxufVxuXG4vKipcbiAqIENvbXBvbmVudCB0byBiZSBzaG93ZWQgaW4gdmlld1xuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVmlld0NvbXBvbmVudCB7XG4gIHB1YmxpYyB2aWV3OiBWaWV3O1xuICBwcm90ZWN0ZWQgY29tcG9uZW50czogVmlld0NvbXBvbmVudFtdID0gW107XG5cbiAgcHVibGljIGNyZWF0ZShfY29tcG9uZW50QWRkZXI6IFZpZXdDb21wb25lbnRBZGRlcik6IHZvaWQge1xuICAgIC8vZW1wdHksIGNhbiBiZSBvdmVycmlkZWQgb3Igbm90XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlKCk6IHZvaWQge1xuICAgIC8vZW1wdHksIGNhbiBiZSBvdmVycmlkZWQgb3Igbm90XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlQ29tcG9uZW50KGNvbXBvbmVudEFkZGVyOiBWaWV3Q29tcG9uZW50QWRkZXIsIHZpZXc6IFZpZXcpOiB2b2lkIHtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuY3JlYXRlKGNvbXBvbmVudEFkZGVyKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIGNvbXBvbmVudC5jcmVhdGVDb21wb25lbnQoY29tcG9uZW50QWRkZXIsIHZpZXcpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVDb21wb25lbnQoKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGUoKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIGNvbXBvbmVudC51cGRhdGVDb21wb25lbnQoKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IGdhbWUoKTogUGhhc2VyLkdhbWUge1xuICAgIHJldHVybiB0aGlzLnZpZXcuZ2FtZTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3ZpZXcudHMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJsb2Rhc2hcIlxuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJAcmVhY3RpdmV4L3J4anNcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJAcmVhY3RpdmV4L3J4anNcIlxuLy8gbW9kdWxlIGlkID0gNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBPYnNlcnZhYmxlLCBPYnNlcnZlciB9IGZyb20gJ0ByZWFjdGl2ZXgvcnhqcyc7XG5cbmV4cG9ydCB0eXBlIEdldE1vZGVsID0gKG1vZGVsOiBhbnkpID0+IGFueTtcblxuZXhwb3J0IGNsYXNzIE1vZGVsV2F0Y2gge1xuICBvYnNlcnZhYmxlOiBPYnNlcnZhYmxlPGFueT47XG4gIG9ic2VydmVyOiBPYnNlcnZlcjxHZXRNb2RlbD47XG4gIGdldE1vZGVsOiBHZXRNb2RlbDtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9tb2RlbF93YXRjaC50cyJdLCJzb3VyY2VSb290IjoiIn0=