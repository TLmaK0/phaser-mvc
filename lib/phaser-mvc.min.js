(function(e, a) { for(var i in a) e[i] = a[i]; }(exports, /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var bootstrap_1 = __webpack_require__(1);
exports.Bootstrap = bootstrap_1.Bootstrap;
var controller_1 = __webpack_require__(3);
exports.Controller = controller_1.Controller;
var view_1 = __webpack_require__(4);
exports.View = view_1.View;
exports.ViewComponent = view_1.ViewComponent;


/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

/**
 */
Object.defineProperty(exports, "__esModule", { value: true });
var Phaser = __webpack_require__(2);
/** Bootstrap for the phaser-mvc.
 * Useage:
 * import { FrameController } from 'phaser-mvc';
 * import { LandEditorController } from 'phaser-mvc';
 * window.onload = () => {
 * const boot = new Bootstrap();
 * boot.addController('FrameController', FrameController);
 */
var Bootstrap = /** @class */ (function () {
    function Bootstrap() {
        var _this = this;
        this.controllers = {};
        this.preload = function () {
            for (var _i = 0, _a = Bootstrap.preloadComponents; _i < _a.length; _i++) {
                var preload = _a[_i];
                preload(_this.game);
            }
        };
        this.create = function () {
            _this.goTo(_this.startAction[0], _this.startAction[1], _this.startAction[2]);
        };
        this.update = function () {
            for (var _i = 0, _a = Object.keys(_this.controllers); _i < _a.length; _i++) {
                var controllerName = _a[_i];
                _this.updateController(_this.controllers[controllerName]);
            }
        };
    }
    Bootstrap.preload = function (preload) {
        Bootstrap.preloadComponents.push(preload);
    };
    Bootstrap.prototype.start = function (controllerName, controllerAction, params) {
        this.startAction = [controllerName, controllerAction, params];
        this.game = new Phaser.Game(Bootstrap.WIDTH, Bootstrap.HEIGHT, Phaser.CANVAS, 'content', { preload: this.preload,
            create: this.create,
            update: this.update });
    };
    Bootstrap.prototype.addController = function (name, controllerType) {
        if (this.controllers[name] != null)
            throw EvalError("Controller " + name + " already registered.");
        var controller = new controllerType();
        controller.bootstrap = this;
        this.controllers[name] = controller;
    };
    Bootstrap.prototype.goTo = function (controllerName, controllerAction, params) {
        /*tslint:disable:no-any*/
        var controller = this.controllers[controllerName];
        /*tslint:enable:no-any*/
        if (!controller) {
            throw EvalError("Controller " + controllerName + " not exist. Be sure you load it in bootstrap.");
        }
        /*tslint:disable:no-unsafe-any*/
        controller[controllerAction](params);
        /*tslint:enable:no-unsafe-any*/
    };
    Bootstrap.prototype.updateController = function (controller) {
        for (var _i = 0, _a = Object.keys(controller.views); _i < _a.length; _i++) {
            var viewName = _a[_i];
            controller.getView(viewName).updateView();
        }
    };
    Bootstrap.WIDTH = 1920;
    Bootstrap.HEIGHT = 1080;
    Bootstrap.preloadComponents = [];
    return Bootstrap;
}());
exports.Bootstrap = Bootstrap;


/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = require("phaser-ce");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Controller accepts input from view and converts modifieds the model.
 */
var Controller = /** @class */ (function () {
    function Controller() {
        var _this = this;
        this.views = {};
        this.model = {};
        this.goTo = function (controllerName, controllerAction, params) {
            _this.bootstrap.goTo(controllerName, controllerAction, params);
        };
    }
    Object.defineProperty(Controller.prototype, "game", {
        get: function () {
            return this.bootstrap.game;
        },
        enumerable: true,
        configurable: true
    });
    Controller.prototype.getView = function (viewName) {
        var view = this.views[viewName];
        if (view == null) {
            throw EvalError("View " + viewName + " not exist. Be sure you have added it to your controller.");
        }
        return view;
    };
    Controller.prototype.render = function (view) {
        view.init(this.game, this.model, this.goTo);
    };
    Controller.prototype.refresh = function (view) {
        view.refresh();
    };
    return Controller;
}());
exports.Controller = Controller;


/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Adds a component to the view and other view components
 */
var ViewComponentAdder = /** @class */ (function () {
    function ViewComponentAdder(components, view) {
        this.components = components;
        this.view = view;
    }
    ViewComponentAdder.prototype.addComponent = function (component) {
        this.components.push(component);
        component.createComponent(this, this.view);
        return component;
    };
    return ViewComponentAdder;
}());
exports.ViewComponentAdder = ViewComponentAdder;
/**
 * Input and ouput for the application
 */
var View = /** @class */ (function () {
    function View() {
        this.components = [];
        this.initiated = false;
    }
    View.prototype.refresh = function () {
        //empty, can be overrided or not
    };
    View.prototype.create = function (_componentAdder) {
        //empty, can be overrided or not
    };
    View.prototype.preload = function () {
        //empty, can be overrided or not
    };
    View.prototype.update = function () {
        //empty, can be overrided or not
    };
    View.prototype.init = function (game, model, goTo) {
        if (!this.initiated) {
            this._game = game;
            this._model = model;
            this._goTo = goTo;
            this.createView();
            this.initiated = true;
        }
    };
    Object.defineProperty(View.prototype, "game", {
        get: function () { return this._game; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "model", {
        get: function () { return this._model; },
        enumerable: true,
        configurable: true
    });
    View.prototype.createView = function () {
        var componentAdder = new ViewComponentAdder(this.components, this);
        this.create(componentAdder);
    };
    View.prototype.updateView = function () {
        if (!this.initiated)
            return;
        this.update();
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.updateComponent();
        }
    };
    View.prototype.refreshView = function () {
        if (!this.initiated)
            throw EvalError('View is not rendered please render it before refresh.');
        this.refresh();
    };
    View.prototype.goTo = function (controllerName, controllerAction, params) {
        this._goTo(controllerName, controllerAction, params);
    };
    return View;
}());
exports.View = View;
/**
 * Component to be showed in view
 */
var ViewComponent = /** @class */ (function () {
    function ViewComponent() {
        this.components = [];
    }
    ViewComponent.prototype.create = function (_componentAdder) {
        //empty, can be overrided or not
    };
    ViewComponent.prototype.update = function () {
        //empty, can be overrided or not
    };
    ViewComponent.prototype.createComponent = function (componentAdder, view) {
        this.view = view;
        this.create(componentAdder);
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.createComponent(componentAdder, view);
        }
    };
    ViewComponent.prototype.updateComponent = function () {
        this.update();
        for (var _i = 0, _a = this.components; _i < _a.length; _i++) {
            var component = _a[_i];
            component.updateComponent();
        }
    };
    Object.defineProperty(ViewComponent.prototype, "game", {
        get: function () {
            return this.view.game;
        },
        enumerable: true,
        configurable: true
    });
    return ViewComponent;
}());
exports.ViewComponent = ViewComponent;


/***/ })
/******/ ])));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgN2ZjYTNlMWNkMGUyZjM0MjljMDYiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9ib290c3RyYXAudHMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicGhhc2VyLWNlXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnRyb2xsZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFFckg7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7Ozs7O0FDN0RBLHlDQUF3QztBQUEvQix5Q0FBUztBQUNsQiwwQ0FBMEM7QUFBakMsNENBQVU7QUFDbkIsb0NBQTZDO0FBQXBDLDBCQUFJO0FBQUUsNENBQWE7Ozs7Ozs7OztBQ0Y1QjtHQUNHOztBQUVILG9DQUFvQztBQU1wQzs7Ozs7OztHQU9HO0FBRUg7SUFBQTtRQUFBLGlCQW1FQztRQTVEVyxnQkFBVyxHQUFtQixFQUFFLENBQUM7UUFtQnBDLFlBQU8sR0FBRztZQUNmLEdBQUcsQ0FBQyxDQUFrQixVQUEyQixFQUEzQixjQUFTLENBQUMsaUJBQWlCLEVBQTNCLGNBQTJCLEVBQTNCLElBQTJCO2dCQUE1QyxJQUFNLE9BQU87Z0JBQ2hCLE9BQU8sQ0FBQyxLQUFJLENBQUMsSUFB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QWtDLEVBQUUsSUFBVTtRQUNuRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQzVCLEdBQUcsQ0FBQyxDQUFvQixVQUFlLEVBQWYsU0FBSSxDQUFDLFVBQVUsRUFBZixjQUFlLEVBQWYsSUFBZTtZQUFsQyxJQUFNLFNBQVM7WUFDbEIsU0FBUyxDQUFDLGVBQWUsQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDakQ7SUFDSCxDQUFDO0lBRU0sdUNBQWUsR0FBdEI7UUFDRSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDZCxHQUFHLENBQUMsQ0FBb0IsVUFBZSxFQUFmLFNBQUksQ0FBQyxVQUFVLEVBQWYsY0FBZSxFQUFmLElBQWU7WUFBbEMsSUFBTSxTQUFTO1lBQ2xCLFNBQVMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztTQUM3QjtJQUNILENBQUM7SUFFRCxzQkFBYywrQkFBSTthQUFsQjtZQUNFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztRQUN4QixDQUFDOzs7T0FBQTtJQUNILG9CQUFDO0FBQUQsQ0FBQztBQTlCcUIsc0NBQWEiLCJmaWxlIjoicGhhc2VyLW12Yy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA3ZmNhM2UxY2QwZTJmMzQyOWMwNiIsImV4cG9ydCB7IEJvb3RzdHJhcCB9IGZyb20gJy4vYm9vdHN0cmFwJztcbmV4cG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICcuL2NvbnRyb2xsZXInO1xuZXhwb3J0IHsgVmlldywgVmlld0NvbXBvbmVudCB9IGZyb20gJy4vdmlldyc7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXgudHMiLCIvKipcbiAqL1xuXG5pbXBvcnQgKiBhcyBQaGFzZXIgZnJvbSAncGhhc2VyLWNlJztcblxuaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJy4vY29udHJvbGxlcic7XG5pbXBvcnQgeyBJQWN0aW9uUGFyYW1zIH0gZnJvbSAnLi9pX2FjdGlvbl9wYXJhbXMnO1xuaW1wb3J0IHsgSUNvbnRyb2xsZXJNYXAgfSBmcm9tICcuL2lfY29udHJvbGxlcl9tYXAnO1xuXG4vKiogQm9vdHN0cmFwIGZvciB0aGUgcGhhc2VyLW12Yy5cbiAqIFVzZWFnZTpcbiAqIGltcG9ydCB7IEZyYW1lQ29udHJvbGxlciB9IGZyb20gJ3BoYXNlci1tdmMnO1xuICogaW1wb3J0IHsgTGFuZEVkaXRvckNvbnRyb2xsZXIgfSBmcm9tICdwaGFzZXItbXZjJztcbiAqIHdpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gKiBjb25zdCBib290ID0gbmV3IEJvb3RzdHJhcCgpO1xuICogYm9vdC5hZGRDb250cm9sbGVyKCdGcmFtZUNvbnRyb2xsZXInLCBGcmFtZUNvbnRyb2xsZXIpO1xuICovXG5cbmV4cG9ydCBjbGFzcyBCb290c3RyYXAge1xuXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgV0lEVEg6IG51bWJlciA9IDE5MjA7XG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSEVJR0hUOiBudW1iZXIgPSAxMDgwO1xuICBwcml2YXRlIHN0YXRpYyBwcmVsb2FkQ29tcG9uZW50czogKChnYW1lOiBQaGFzZXIuR2FtZSkgPT4gdm9pZClbXSA9IFtdO1xuXG4gIHB1YmxpYyBnYW1lOiBQaGFzZXIuR2FtZTtcbiAgcHJvdGVjdGVkIGNvbnRyb2xsZXJzOiBJQ29udHJvbGxlck1hcCA9IHt9O1xuICBwcml2YXRlIHN0YXJ0QWN0aW9uOiBbc3RyaW5nLCBzdHJpbmcsIElBY3Rpb25QYXJhbXNdO1xuXG4gIHB1YmxpYyBzdGF0aWMgcHJlbG9hZChwcmVsb2FkOiAoZ2FtZTogUGhhc2VyLkdhbWUpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBCb290c3RyYXAucHJlbG9hZENvbXBvbmVudHMucHVzaChwcmVsb2FkKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGFydChjb250cm9sbGVyTmFtZTogc3RyaW5nLCBjb250cm9sbGVyQWN0aW9uOiBzdHJpbmcsIHBhcmFtczogSUFjdGlvblBhcmFtcyk6IHZvaWQge1xuICAgIHRoaXMuc3RhcnRBY3Rpb24gPSBbY29udHJvbGxlck5hbWUsIGNvbnRyb2xsZXJBY3Rpb24sIHBhcmFtc107XG4gICAgdGhpcy5nYW1lID0gbmV3IFBoYXNlci5HYW1lKFxuICAgICAgQm9vdHN0cmFwLldJRFRILFxuICAgICAgQm9vdHN0cmFwLkhFSUdIVCxcbiAgICAgIFBoYXNlci5DQU5WQVMsXG4gICAgICAnY29udGVudCcsXG4gICAgICB7IHByZWxvYWQ6IHRoaXMucHJlbG9hZCxcbiAgICAgICAgY3JlYXRlOiB0aGlzLmNyZWF0ZSxcbiAgICAgICAgdXBkYXRlOiB0aGlzLnVwZGF0ZX0pO1xuICB9XG5cbiAgcHVibGljIHByZWxvYWQgPSAoKTogdm9pZCA9PiB7XG4gICAgZm9yIChjb25zdCBwcmVsb2FkIG9mIEJvb3RzdHJhcC5wcmVsb2FkQ29tcG9uZW50cykge1xuICAgICAgcHJlbG9hZCh0aGlzLmdhbWUpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGUgPSAoKTogdm9pZCA9PiB7XG4gICAgdGhpcy5nb1RvKHRoaXMuc3RhcnRBY3Rpb25bMF0sIHRoaXMuc3RhcnRBY3Rpb25bMV0sIHRoaXMuc3RhcnRBY3Rpb25bMl0pO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZSA9ICgpOiB2b2lkID0+IHtcbiAgICBmb3IgKGNvbnN0IGNvbnRyb2xsZXJOYW1lIG9mIE9iamVjdC5rZXlzKHRoaXMuY29udHJvbGxlcnMpKSB7XG4gICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xsZXIoPENvbnRyb2xsZXI+dGhpcy5jb250cm9sbGVyc1tjb250cm9sbGVyTmFtZV0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhZGRDb250cm9sbGVyPFQgZXh0ZW5kcyBDb250cm9sbGVyPihuYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJUeXBlOiBuZXcgKCkgPT4gVCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbnRyb2xsZXJzW25hbWVdICE9IG51bGwpIHRocm93IEV2YWxFcnJvcihgQ29udHJvbGxlciAke25hbWV9IGFscmVhZHkgcmVnaXN0ZXJlZC5gKTtcblxuICAgIGNvbnN0IGNvbnRyb2xsZXI6IFQgPSBuZXcgY29udHJvbGxlclR5cGUoKTtcbiAgICBjb250cm9sbGVyLmJvb3RzdHJhcCA9IHRoaXM7XG4gICAgdGhpcy5jb250cm9sbGVyc1tuYW1lXSA9IGNvbnRyb2xsZXI7XG4gIH1cblxuICBwdWJsaWMgZ29Ubyhjb250cm9sbGVyTmFtZTogc3RyaW5nLCBjb250cm9sbGVyQWN0aW9uOiBzdHJpbmcsIHBhcmFtczogSUFjdGlvblBhcmFtcyk6IHZvaWQge1xuICAgIC8qdHNsaW50OmRpc2FibGU6bm8tYW55Ki9cbiAgICBjb25zdCBjb250cm9sbGVyOiBhbnkgPSB0aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJOYW1lXTtcbiAgICAvKnRzbGludDplbmFibGU6bm8tYW55Ki9cbiAgICBpZiAoIWNvbnRyb2xsZXIpIHtcbiAgICAgIHRocm93IEV2YWxFcnJvcihgQ29udHJvbGxlciAke2NvbnRyb2xsZXJOYW1lfSBub3QgZXhpc3QuIEJlIHN1cmUgeW91IGxvYWQgaXQgaW4gYm9vdHN0cmFwLmApO1xuICAgIH1cbiAgICAvKnRzbGludDpkaXNhYmxlOm5vLXVuc2FmZS1hbnkqL1xuICAgIGNvbnRyb2xsZXJbY29udHJvbGxlckFjdGlvbl0ocGFyYW1zKTtcbiAgICAvKnRzbGludDplbmFibGU6bm8tdW5zYWZlLWFueSovXG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUNvbnRyb2xsZXIoY29udHJvbGxlcjogQ29udHJvbGxlcik6IHZvaWQge1xuICAgIGZvciAoY29uc3Qgdmlld05hbWUgb2YgT2JqZWN0LmtleXMoY29udHJvbGxlci52aWV3cykpIHtcbiAgICAgIGNvbnRyb2xsZXIuZ2V0Vmlldyh2aWV3TmFtZSkudXBkYXRlVmlldygpO1xuICAgIH1cbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2Jvb3RzdHJhcC50cyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInBoYXNlci1jZVwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInBoYXNlci1jZVwiXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIFBoYXNlciBmcm9tICdwaGFzZXItY2UnO1xuXG5pbXBvcnQgeyBCb290c3RyYXAgfSBmcm9tICcuL2Jvb3RzdHJhcCc7XG5pbXBvcnQgeyBJQWN0aW9uUGFyYW1zIH0gZnJvbSAnLi9pX2FjdGlvbl9wYXJhbXMnO1xuaW1wb3J0IHsgSUNvbnRyb2xsZXJNYXAgfSBmcm9tICcuL2lfY29udHJvbGxlcl9tYXAnO1xuaW1wb3J0IHsgSU1vZGVsIH0gZnJvbSAnLi9pX21vZGVsJztcbmltcG9ydCB7IElWaWV3TWFwIH0gZnJvbSAnLi9pX3ZpZXdfbWFwJztcbmltcG9ydCB7IFZpZXcgfSBmcm9tICcuL3ZpZXcnO1xuXG4vKipcbiAqIENvbnRyb2xsZXIgYWNjZXB0cyBpbnB1dCBmcm9tIHZpZXcgYW5kIGNvbnZlcnRzIG1vZGlmaWVkcyB0aGUgbW9kZWwuXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb250cm9sbGVyIHtcbiAgcHVibGljIHZpZXdzOiBJVmlld01hcCA9IHt9O1xuICBwdWJsaWMgYm9vdHN0cmFwOiBCb290c3RyYXA7XG4gIHB1YmxpYyBtb2RlbDogSU1vZGVsID0ge307XG5cbiAgcHVibGljIGdldCBnYW1lKCk6IFBoYXNlci5HYW1lIHtcbiAgICByZXR1cm4gdGhpcy5ib290c3RyYXAuZ2FtZTtcbiAgfVxuXG4gIHB1YmxpYyBnb1RvID0gKGNvbnRyb2xsZXJOYW1lOiBzdHJpbmcsIGNvbnRyb2xsZXJBY3Rpb246IHN0cmluZywgcGFyYW1zOiBJQWN0aW9uUGFyYW1zKSA9PiB7XG4gICAgdGhpcy5ib290c3RyYXAuZ29Ubyhjb250cm9sbGVyTmFtZSwgY29udHJvbGxlckFjdGlvbiwgcGFyYW1zKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRWaWV3KHZpZXdOYW1lOiBzdHJpbmcpOiBWaWV3IHtcbiAgICBjb25zdCB2aWV3ID0gdGhpcy52aWV3c1t2aWV3TmFtZV07XG4gICAgaWYgKHZpZXcgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgRXZhbEVycm9yKGBWaWV3ICR7dmlld05hbWV9IG5vdCBleGlzdC4gQmUgc3VyZSB5b3UgaGF2ZSBhZGRlZCBpdCB0byB5b3VyIGNvbnRyb2xsZXIuYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZpZXc7XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVuZGVyKHZpZXc6IFZpZXcpOiB2b2lkIHtcbiAgICB2aWV3LmluaXQodGhpcy5nYW1lLCB0aGlzLm1vZGVsLCB0aGlzLmdvVG8pO1xuICB9XG5cbiAgcHJvdGVjdGVkIHJlZnJlc2godmlldzogVmlldyk6IHZvaWQge1xuICAgIHZpZXcucmVmcmVzaCgpO1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29udHJvbGxlci50cyIsImltcG9ydCAqIGFzIFBoYXNlciBmcm9tICdwaGFzZXItY2UnO1xuXG5pbXBvcnQgeyBJQWN0aW9uUGFyYW1zIH0gZnJvbSAnLi9pX2FjdGlvbl9wYXJhbXMnO1xuaW1wb3J0IHsgSU1vZGVsIH0gZnJvbSAnLi9pX21vZGVsJztcblxuLyoqXG4gKiBBZGRzIGEgY29tcG9uZW50IHRvIHRoZSB2aWV3IGFuZCBvdGhlciB2aWV3IGNvbXBvbmVudHNcbiAqL1xuZXhwb3J0IGNsYXNzIFZpZXdDb21wb25lbnRBZGRlciB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY29tcG9uZW50czogVmlld0NvbXBvbmVudFtdLCBwcml2YXRlIHZpZXc6IFZpZXcpIHt9XG5cbiAgcHVibGljIGFkZENvbXBvbmVudDxUIGV4dGVuZHMgVmlld0NvbXBvbmVudD4oY29tcG9uZW50OiBUKTogVCB7XG4gICAgdGhpcy5jb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICBjb21wb25lbnQuY3JlYXRlQ29tcG9uZW50KHRoaXMsIHRoaXMudmlldyk7XG5cbiAgICByZXR1cm4gY29tcG9uZW50O1xuICB9XG59XG5cbi8qKlxuICogSW5wdXQgYW5kIG91cHV0IGZvciB0aGUgYXBwbGljYXRpb25cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFZpZXcge1xuICBwcm90ZWN0ZWQgY29tcG9uZW50czogVmlld0NvbXBvbmVudFtdID0gW107XG4gIHByb3RlY3RlZCBpbml0aWF0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfZ2FtZTogUGhhc2VyLkdhbWU7XG4gIHByaXZhdGUgX21vZGVsOiBJTW9kZWw7XG4gIHByaXZhdGUgX2dvVG86IChjb250cm9sbGVyTmFtZTogc3RyaW5nLCBjb250cm9sbGVyQWN0aW9uOiBzdHJpbmcsIHBhcmFtczogSUFjdGlvblBhcmFtcykgPT4gdm9pZDtcblxuICBwdWJsaWMgcmVmcmVzaCgpIHtcbiAgICAvL2VtcHR5LCBjYW4gYmUgb3ZlcnJpZGVkIG9yIG5vdFxuICB9XG4gIHB1YmxpYyBjcmVhdGUoX2NvbXBvbmVudEFkZGVyOiBWaWV3Q29tcG9uZW50QWRkZXIpIHtcbiAgICAvL2VtcHR5LCBjYW4gYmUgb3ZlcnJpZGVkIG9yIG5vdFxuICB9XG4gIHB1YmxpYyBwcmVsb2FkKCkge1xuICAgIC8vZW1wdHksIGNhbiBiZSBvdmVycmlkZWQgb3Igbm90XG4gIH1cbiAgcHVibGljIHVwZGF0ZSgpIHtcbiAgICAvL2VtcHR5LCBjYW4gYmUgb3ZlcnJpZGVkIG9yIG5vdFxuICB9XG5cbiAgcHVibGljIGluaXQoZ2FtZTogUGhhc2VyLkdhbWUsIG1vZGVsOiBJTW9kZWwsIGdvVG86IChjb250cm9sbGVyTmFtZTogc3RyaW5nLCBjb250cm9sbGVyQWN0aW9uOiBzdHJpbmcsIHBhcmFtczogSUFjdGlvblBhcmFtcykgPT4gdm9pZCkge1xuICAgIGlmICghdGhpcy5pbml0aWF0ZWQpIHtcbiAgICAgIHRoaXMuX2dhbWUgPSBnYW1lO1xuICAgICAgdGhpcy5fbW9kZWwgPSBtb2RlbDtcbiAgICAgIHRoaXMuX2dvVG8gPSBnb1RvO1xuICAgICAgdGhpcy5jcmVhdGVWaWV3KCk7XG4gICAgICB0aGlzLmluaXRpYXRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGdhbWUoKTogUGhhc2VyLkdhbWUgeyByZXR1cm4gdGhpcy5fZ2FtZTsgfVxuXG4gIGdldCBtb2RlbCgpOiBJTW9kZWwgeyByZXR1cm4gdGhpcy5fbW9kZWw7IH1cblxuICBwdWJsaWMgY3JlYXRlVmlldygpIHtcbiAgICBjb25zdCBjb21wb25lbnRBZGRlciA9IG5ldyBWaWV3Q29tcG9uZW50QWRkZXIodGhpcy5jb21wb25lbnRzLCB0aGlzKTtcbiAgICB0aGlzLmNyZWF0ZShjb21wb25lbnRBZGRlcik7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlVmlldygpIHtcbiAgICBpZiAoIXRoaXMuaW5pdGlhdGVkKSByZXR1cm47XG4gICAgdGhpcy51cGRhdGUoKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIGNvbXBvbmVudC51cGRhdGVDb21wb25lbnQoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcmVmcmVzaFZpZXcoKSB7XG4gICAgaWYgKCF0aGlzLmluaXRpYXRlZCkgdGhyb3cgRXZhbEVycm9yKCdWaWV3IGlzIG5vdCByZW5kZXJlZCBwbGVhc2UgcmVuZGVyIGl0IGJlZm9yZSByZWZyZXNoLicpO1xuICAgIHRoaXMucmVmcmVzaCgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdvVG8oY29udHJvbGxlck5hbWU6IHN0cmluZywgY29udHJvbGxlckFjdGlvbjogc3RyaW5nLCBwYXJhbXM6IElBY3Rpb25QYXJhbXMpOiB2b2lkIHtcbiAgICB0aGlzLl9nb1RvKGNvbnRyb2xsZXJOYW1lLCBjb250cm9sbGVyQWN0aW9uLCBwYXJhbXMpO1xuICB9XG59XG5cbi8qKlxuICogQ29tcG9uZW50IHRvIGJlIHNob3dlZCBpbiB2aWV3XG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBWaWV3Q29tcG9uZW50IHtcbiAgcHVibGljIHZpZXc6IFZpZXc7XG4gIHByb3RlY3RlZCBjb21wb25lbnRzOiBWaWV3Q29tcG9uZW50W10gPSBbXTtcblxuICBwdWJsaWMgY3JlYXRlKF9jb21wb25lbnRBZGRlcjogVmlld0NvbXBvbmVudEFkZGVyKTogdm9pZCB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGUoKTogdm9pZCB7XG4gICAgLy9lbXB0eSwgY2FuIGJlIG92ZXJyaWRlZCBvciBub3RcbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGVDb21wb25lbnQoY29tcG9uZW50QWRkZXI6IFZpZXdDb21wb25lbnRBZGRlciwgdmlldzogVmlldyk6IHZvaWQge1xuICAgIHRoaXMudmlldyA9IHZpZXc7XG4gICAgdGhpcy5jcmVhdGUoY29tcG9uZW50QWRkZXIpO1xuICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIHRoaXMuY29tcG9uZW50cykge1xuICAgICAgY29tcG9uZW50LmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRBZGRlciwgdmlldyk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHVwZGF0ZUNvbXBvbmVudCgpOiB2b2lkIHtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIHRoaXMuY29tcG9uZW50cykge1xuICAgICAgY29tcG9uZW50LnVwZGF0ZUNvbXBvbmVudCgpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBnZXQgZ2FtZSgpOiBQaGFzZXIuR2FtZSB7XG4gICAgcmV0dXJuIHRoaXMudmlldy5nYW1lO1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdmlldy50cyJdLCJzb3VyY2VSb290IjoiIn0=